/*!
 * Copyright (C) 2013, Edmundo Albuquerque de Souza e Silva.
 *
 * This file may be distributed under the terms of the Q Public License
 * as defined by Trolltech AS of Norway and appearing in the file
 * LICENSE.QPL included in the packaging of this file.
 *
 * THIS FILE IS PROVIDED AS IS WITH NO WARRANTY OF ANY KIND, INCLUDING
 * THE WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
 * FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
 * NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */
var RIOxmlDoc;var RIOxmlIndex=null;var RIOxmlSync=null;var RIOrelativeUrl;var RIOloadUrl;var RIOpwdXmlFile;var RIOindexFile=null;var RIOindexFileRIO=null;var RIOsyncFile=null;var RIOsyncFileRIO=null;var RIObaseRIODir;var RIObaseRIODirAll;var RIOvideoFile=new Array();var RIOcurrent_slide=0;var RIOcurrent_action=-1;var RIOcurrent_topic=0;var RIOsession_id=0;var RIOxmlTitle;var RIOxmlAuthor;var RIOxmlCourse;var RIOvideoElem;var RIOindexElem;var RIOslidesElem;var RIOsyncCheckBox="true";var RIOos;var RIOlogVersion="1.3";var RIOwebserver;var RIOlogWebServer="logvideoaula-idc.rnp.br";var RIOurllog=location.protocol+"//"+RIOlogWebServer+"/userlog.rio?logline=";var RIOforceLog="false";var RIOlocalAccess="false";var RIOopinion="false";var RIOdownloadlog;var RIObufferVideoMsgInterval="5000";var xmlOldVersion="false";var videoSlidePos=0;var RIOEdit="false";var RIOuploadPath="riocomposerweb/upload.php";var RIOuploadxmlPath="riocomposerweb/upload_xml.php";var RIOcommandPath="riocomposerweb/command.php";var RIOVideoSubtitlesFileName=new Array();var RIOVideoSubtitlesDefaultIndex=-1;var RIOVideoSubtitlesDescription=new Array();var RIOVideoSubtitlesLanguage=new Array();var RIOLibrasFile=new Array();var RIOVideoReady=false;var RIOLibrasReady=true;var RIOUseLibras=false;var RIOLibrasRatio=0.35;var RIOStartVideos=true;var RIOTest="false";var RIOEditTemplates=new Array();var RIOEditTemplatesnames=new Array();var RIOEditNewFileName="";_browser={};var listFiles=[];var fList=[];var embedActive="false";function RIOdebug(a){document.getElementById("RIOdebug").innerHTML+=RIOgetDateTime()+": "+a+"<br>";document.getElementById("RIOdebug").scrollTop=document.getElementById("RIOdebug").scrollHeight}function RIOdebugControl(){var b=false;var d=false;var a=false;RIOdebug("RIOdebugControl: Shortcut debug");document.onkeyup=function(f){if(f.which==16){b=false}};document.onkeyup=function(f){if(f.which==17){d=false}};document.onkeyup=function(f){if(f.which==18){a=false}};document.onkeydown=function(f){if(f.which==16){b=true}if(f.which==17){d=true}if(f.which==18){a=true}if(f.which==68&&b==true&&d==true&&a==true){if(document.getElementById("RIOdebug").style.display!="inline"){document.getElementById("RIOdebug").style.display="inline"}else{document.getElementById("RIOdebug").style.display="none"}return false}}}function RIOenableDebug(){if(document.getElementById("RIOdebug").style.display!="inline"){document.getElementById("RIOdebug").style.display="inline"}else{document.getElementById("RIOdebug").style.display="none"}}function RIOsetOS(){var a=RIOdetectOS();return(a.isUbuntu)?("Ubuntu"):(a.isAndroid)?("Android"):(a.isLinux)?("Linux"):(a.isiOS)?("iOS"):(a.isiPad)?("iOS"):(a.isOSX)?("OSX"):(a.isBlackBerry)?("BlackBerry"):(a.isWP)?("Windows_Phone"):(a.isWin)?("Windows"):("Unknown")}function RIOdetectOS(){var a=navigator.userAgent.toLowerCase();return{isUbuntu:/ubuntu/.test(a),isAndroid:/android/.test(a),isLinux:/linux/.test(a),isiOS:/iphone os/.test(a),isiPad:/ipad/.test(a),isOSX:/mac os x/.test(a),isBlackBerry:/blackberry/.test(a),isWP:/windows phone/.test(a),isWin:/trindent/.test(a),isWin:/windows nt/.test(a)}}function RIOloadXMLDoc(e,a){var d;var f;if(RIOlocalAccess=="true"&&RIObrowser().substr(0,4)=="MSIE"){d=new ActiveXObject("Microsoft.XMLHTTP");if(a=="true"){d.open("GET",e,true)}else{d.open("GET",e,false)}d.send(null);if((d.status!=200)&&(d.status!=0)){if(d.status==403){RIOdebug("Erro ao ler "+e+": Permissão negada");alert("Permissão negada")}else{RIOdebug("Erro ao ler "+e+": "+d.statusText);alert(d.statusText)}}else{f=(new DOMParser()).parseFromString(d.responseText,"text/xml")}}else{d=new XMLHttpRequest();if(a=="true"){d.open("GET",e,true)}else{d.open("GET",e,false)}if(RIObrowser().substr(0,4)!="MSIE"){d.overrideMimeType("text/xml")}try{d.send(null);if((d.status!=200)&&(d.status!=0)){if(d.status==403){RIOdebug("Erro ao ler "+e+": Permissão negada");alert("Permissão negada")}else{RIOdebug("Erro ao ler "+e+": "+d.statusText);alert(d.statusText)}}else{f=d.responseXML}}catch(b){f=b.description;RIOdebug("RIOloadXMLDoc: "+b.toString())}}return f}function RIObrowser(){var d=navigator.appName,b=navigator.userAgent,a;var e=b.match(/(opera|chrome|safari|firefox|msie|trident|edge)\/?\s*(\.?\d+(\.\d+)*)/i);if(e&&(a=b.match(/version\/([\.\d]+)/i))!=null){e[2]=a[1]}e=e?[e[1],e[2]]:[d,navigator.appVersion,"-?"];if(String(e)=="Trident,7.0"){e="MSIE,11"}return String(e)}function getIsPC(){if(bowser.tablet==undefined&&bowser.mobile==undefined){return true}else{return false}}function getIsTab(){if(bowser.tablet==true){return bowser.tablet}else{return false}}function getIsMob(){if(bowser.mobile==true){return bowser.mobile}else{return false}}function getVersion(){if(bowser.version!==undefined){return bowser.version}else{return false}}function getVersionOS(){if(bowser.osversion!==undefined){return bowser.osversion}else{return false}}function getBrowser(){if(bowser.name.toLowerCase()=="microsoft edge"){return"Edge"}else{if(bowser.name.toLowerCase()=="internet explorer"){return"MSIE"}else{return bowser.name}}}function getOS(){if(bowser.mac==true){return"Macos"}else{if(bowser.windows==true){return"Windows"}else{if(bowser.windowsphone==true){return"MSIE"}else{if(bowser.linux==true){return"Linux"}else{if(bowser.chromeos==true){return"Chromeos"}else{if(bowser.android==true){return"Android"}else{if(bowser.ios==true){return"Ios"}else{if(bowser.blackberry==true){return"Blackberry"}else{if(bowser.firefoxos==true){return"Firefoxos"}else{if(bowser.webos==true){return"Webos"}else{if(bowser.bada==true){return"Bada"}else{if(bowser.tizen==true){return"Tizen"}else{if(bowser.sailfish==true){return"Sailfish"}}}}}}}}}}}}}}function RIObrowserMobile(b){var a={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)}};if(a.Android()){b[0]="Android"}else{if(a.BlackBerry()){b[0]="BlackBerry"}else{if(a.iOS()){b[0]="iOS"}else{if(a.Opera()){b[0]="Opera"}else{if(a.Windows()){b[0]="Windows"}else{b[0]="Mobile"}}}}}}function detectBrowser(){var a=[];if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){strBro=RIObrowserMobile(a)}else{strBro=RIObrowser2(a)}console.log(strBro)}function RIOstateMsg(){RIObuildStatusLogMsg("STATE")}function RIObufferVideoMsg(){var b=RIOdownloadlog;RIOdownloadlog=RIOvideoElem.buffered.length;for(i=0;i<RIOvideoElem.buffered.length;i++){RIOdownloadlog+=" "+RIOvideoElem.buffered.start(i)+" "+RIOvideoElem.buffered.end(i)}if(b!=RIOdownloadlog){var a=RIOsession_id+"*"+RIOgetDateTime()+"*BUFFERVIDEO*"+RIOvideoElem.duration+"*"+RIOdownloadlog;RIOsendlog(a)}}function RIOStartVideo(){if(RIOEdit!=="true"){RIOVideoReady=true;if(((!RIOUseLibras)||(RIOLibrasReady))&&(RIOStartVideos)){document.getElementById("RIOvideo").play();if(RIOUseLibras){document.getElementById("RIOlibrasvideo").play()}RIOStartVideos=false}}}function toggleControls(a){}function RIOloadVideo(b){RIOdebug("RIOloadVideo: Loading Video");var a="";RIOvideoElem=document.getElementById("RIOvideo");for(i=0;i<RIOvideoFile.length;i++){switch(RIOvideoFile[i].substr(RIOvideoFile[i].lastIndexOf("."),RIOvideoFile[i].length)){case".mp4":a+='  <source src="'+RIOvideoFile[i]+'" type="video/mp4" />';break;case".webm":a+='  <source src="'+RIOvideoFile[i]+'" type="video/webm" />';break;case".flv":a+='  <source src="'+RIOvideoFile[i].substr(0,RIOvideoFile[i].lastIndexOf("."))+'.mp4" type="video/mp4" />';a+='  <source src="'+RIOvideoFile[i].substr(0,RIOvideoFile[i].lastIndexOf("."))+'.webm" type="video/webm" />';break}}a+="Este navegador não tem suporte a tag video do HTML!";RIOvideoElem.innerHTML+=a;RIOVideoReady=false;if(b!="true"){RIOvideoElem.addEventListener("timeupdate",function(d){RIOTimeUpdate()},false)}RIOvideoElem.addEventListener("canplaythrough",function(d){RIObuildStatusLogMsg("PLAY")},false);RIOvideoElem.addEventListener("play",function(d){RIObuildStatusLogMsg("PLAY");RIOsyncLibras("PLAY")},false);RIOvideoElem.addEventListener("pause",function(d){RIObuildStatusLogMsg("PAUSE");RIOsyncLibras("PAUSE")},false);RIOvideoElem.addEventListener("ended",function(d){RIObuildStatusLogMsg("STOP");RIOsyncLibras("STOP")},false);RIOvideoElem.addEventListener("seeked",function(d){RIOexecSeekedListener(RIOvideoElem.currentTime);RIOsyncLibras("TIME")},false);RIOvideoElem.addEventListener("seeking",function(d){RIOsyncLibras("TIME")},false);RIOvideoElem.addEventListener("canplay",function(d){RIOStartVideo()},false)}function RIOTimeUpdate(){if(RIOindexFile!==null){RIOupdateCurrentTopic(RIOvideoElem.currentTime)}if(RIOsyncFile!==null){RIOloadSlides(RIOvideoElem.currentTime);toggleControls(document.getElementById("RIOvideo"))}}function RIOsyncLibras(a){if(RIOUseLibras){var b=document.getElementById("RIOlibrasvideo");switch(a){case"PLAY":b.play();break;case"PAUSE":b.pause();break;case"STOP":b.pause();b.currentTime=0;break;case"TIME":b.currentTime=RIOvideoElem.currentTime}}}function RIOloadXmlFile(){var b=new Date();var f=b.getMonth();var a=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];var d=b.getYear();if(d<1000){d+=1900}b=b.getDay()+" "+a[f-1]+" "+d+"  -  "+b.getHours()+":"+b.getMinutes()+":"+b.getSeconds()+".";RIOdebug("RIOloadXmlFile: Loading XmlFile");if(RIOEdit==="true"){var e='<table class="RIOtableInfoBar" style="font-size: 130%;">';e+="<tr>";e+="<td>";e+="<strong>";e+="Disciplina:";e+="</strong> "+RIOxmlCourse+" - ";e+="</td>";e+="<td>";e+="<strong> Aula: </strong> "+RIOxmlTitle+" - ";e+="</td>";e+="<td>";e+="<strong> Professor: </strong> "+RIOxmlAuthor+" </td>";e+="</tr>";e+="</table>";e+='<table class="saving-slides">';e+="<tr>";e+='<td style="width: 50%;">';e+='<p class="saving"> Salvo em '+b+" </p>";e+="</td>";e+="</tr>";e+="</table>"}else{if(embedActive=="true"){var e='<table class="RIOtableInfoBar" style="max-width: 85%; margin-right: auto; vertical-align: middle; height: 100%; display: inline-block; position: relative; top: 20%;">';e+="<tr>";if(RIOxmlCourse.length>20){e+='<td title="'+RIOxmlCourse+'" style="white-space: nowrap;">';e+="<strong>";e+="Disciplina:";e+="</strong> "+RIOxmlCourse.slice(0,(RIOxmlCourse.length-5))+"... "}else{e+='<td style="white-space: nowrap;">';e+="<strong>";e+="Disciplina:";e+="</strong> "+RIOxmlCourse+" - ";e+="</td>"}if(RIOxmlTitle.length>20){e+="</td>";e+='<td title="'+RIOxmlTitle+'" style="white-space: nowrap;">';e+="<strong> Aula: </strong> "+RIOxmlTitle.slice(0,(RIOxmlTitle.length-5))+"... ";e+="</td>"}else{e+='<td style="white-space: nowrap;">';e+="<strong> Aula: </strong> "+RIOxmlTitle+" - ";e+="</td>"}if(RIOxmlAuthor.length>20){e+='<td title="'+RIOxmlAuthor+'" style="white-space: nowrap;">';e+="<strong> Professor: </strong> "+RIOxmlAuthor.slice(0,(RIOxmlAuthor.length-5))+"... </td>"}else{e+='<td style="white-space: nowrap;">';e+="<strong> Professor: </strong> "+RIOxmlAuthor+" </td>"}e+="</tr>";e+="</table>";e+='<div id="divCreative" style="float: right; position: relative; top: 25%; right: 1%; width: 2%; height: 40%;"  onclick="ballonRights();" >';e+='<iframe id="creativeImage" class="bars" src="rioload.html?f='+RIOwebserver+'/images/copyright.png" style="width: 100%; height: 100%;" onload="iframeClickCreative()"></iframe>';e+="</div>"}else{var e='<table class="RIOtableInfoBar" style="max-width: 85%; margin-right: auto; vertical-align: middle; font-size: 120%; height: 100%;">';e+="<tr>";e+="<td>";e+="<strong>";e+="Disciplina:";e+="</strong> "+RIOxmlCourse+" - ";e+="</td>";e+="<td>";e+="<strong> Aula: </strong> "+RIOxmlTitle+" - ";e+="</td>";e+="<td>";e+="<strong> Professor: </strong> "+RIOxmlAuthor+" </td>";e+="</tr>";e+="</table>"}}document.getElementById("RIOinfo").innerHTML=e}function RIOSendXmlDataToServer(b,a){var d=new XMLHttpRequest();d.open("POST",a,false);d.setRequestHeader("Content-Type","text/xml");d.send(b);if((d.status!=200)&&(d.status!=0)){if(d.status==403){alert("Permissão negada!")}else{alert("Erro "+d.statusText+"ao enviar o XML!")}}}function RIOStartLibras(){var b=document.getElementById("RIOLibras");var d=document.getElementById("RIOlibrasvideo");var a=165;b.style.width=a+"px";b.style.height=parseFloat(a*(d.videoHeight/d.videoWidth))+"px";RIOLibrasReady=true;if((RIOVideoReady)&&(RIOStartVideos)){document.getElementById("RIOvideo").play();document.getElementById("RIOlibrasvideo").play();RIOStartVideos=false}}function RIOCloseLibras(){document.getElementById("RIOLibras").style.display="none"}function RIODragStartLibras(a){a.dataTransfer.setData("text/plain","precisaterdados");return true}function RIODropLibras(b){var a=document.getElementById("RIOLibras");a.style.position="absolute";a.style.left=b.clientX-70+"px";a.style.top=b.clientY-70+"px";b.preventDefault();return false}function RIODragOverLibras(a){a.preventDefault();return false}function RIOloadLibras(){if(RIOLibrasFile.length>0){RIOdebug("RIOloadLibras: Loading libras");var d="";if(RIOTest!=="true"){d='<div class="RIOdivLibrasClose">';d+='<label class="RIOLibrasClose" onclick="RIOCloseLibras()">';d+="X";d+="</label>";d+="</div>"}d+='<video id="RIOlibrasvideo" class="RIOlibrascss" width="100%" height="100%" preload="auto" webkit-playsinline muted>';var b=document.getElementById("RIOLibras");b.setAttribute("style","top: 50%; right: 67%;");for(i=0;i<RIOLibrasFile.length;i++){switch(RIOLibrasFile[i].substr(RIOLibrasFile[i].lastIndexOf("."),RIOLibrasFile[i].length)){case".mp4":d+='<source src="'+RIOLibrasFile[i]+'" type="video/mp4" />';break;case".webm":d+='<source src="'+RIOLibrasFile[i]+'" type="video/webm" />';break;case".flv":d+='<source src="'+RIOLibrasFile[i].substr(0,RIOLibrasFile[i].lastIndexOf("."))+'.mp4" type="video/mp4" />';d+='<source src="'+RIOLibrasFile[i].substr(0,RIOLibrasFile[i].lastIndexOf("."))+'.webm" type="video/webm" />';break}}d+="Este navegador não tem suporte a tag video do HTML!";d+="</video>";b.innerHTML=d;RIOLibrasReady=false;RIOUseLibras=true;var e=document.getElementById("RIOlibrasvideo");var a=document.getElementById("divvideo");e.addEventListener("canplay",function(f){RIOStartLibras()},false);b.addEventListener("dragstart",RIODragStartLibras,false);document.body.addEventListener("dragover",RIODragOverLibras,false);document.body.addEventListener("drop",RIODropLibras,false);if(RIOTest==="true"){document.getElementById("librasclass").style.display="inline-block";document.getElementById("RIOLibras").style.display="none";document.getElementById("RIOLibras-tool-fixed").innerHTML=d;document.getElementById("RIOLibras-tool-fixed").style.display="none";document.getElementsByClassName("btn-bar")[0].setAttribute("style","border-left: 1px solid gray;")}else{if(RIOTest!=="true"){document.getElementById("RIOLibras").style.display="inline"}}}else{RIOUseLibras=false;RIOdebug("RIOloadLibras: No libras found")}}function RIOinitTemplates(){}function RIOexecSeekedListener(d){var b=-1;var a=-1;if(RIOsyncFile!==null){b=RIOfindNewSlideIndex(d)}if(RIOindexFile!==null){a=RIOfindNewTopicIndex(d)}RIObuildSendLog("PROGRESSBAR_CHANGED",b,a)}function RIOfindNewSlideIndex(a){for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){if(i==(RIOxmlSync.getElementsByTagName("slide").length-1)){break}else{if(a>=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").nodeValue&&a<RIOxmlSync.getElementsByTagName("slide")[i+1].attributes.getNamedItem("time").nodeValue){break}}}return i}function RIOfindNewTopicIndex(a){for(i=0;i<RIOxmlIndex.getElementsByTagName("ind_item").length;i++){if(i==(RIOxmlIndex.getElementsByTagName("ind_item").length-1)){break}else{if(a>=RIOxmlIndex.getElementsByTagName("ind_item")[i].getElementsByTagName("time")[0].childNodes[0].nodeValue&&a<RIOxmlIndex.getElementsByTagName("ind_item")[i+1].getElementsByTagName("time")[0].childNodes[0].nodeValue){break}}}return i}function RIOgotoIndex(a){if(RIOsyncFile!==null){RIObuildSendLog("TOPIC_CHANGED",RIOfindNewSlideIndex(RIOvideoElem.currentTime),a)}else{RIObuildSendLog("TOPIC_CHANGED",-1,a)}RIOvideoElem.currentTime=RIOxmlIndex.getElementsByTagName("ind_item")[a].getElementsByTagName("time")[0].childNodes[0].nodeValue}function RIOloadIndex(){RIOdebug("RIOloadIndex: Loading Index");var e=RIOxmlIndex.getElementsByTagName("ind_item").length;var d=new Array();var b=new Array();if(embedActive=="true"){var a='<ul style="cursor: default;">'}else{var a="<ul>"}RIOindexElem=document.getElementById("index");for(i=0;i<e;i++){d[i]=RIOxmlIndex.getElementsByTagName("ind_item")[i].getElementsByTagName("ind_item").length}for(i=0;i<e;i++){if(d[i]==0){a+=RIOgetIndex(i)}else{b.push(d[i]);a+=RIOgetIndex(i);a+="<ul>"}for(j=0;j<b.length;j++){b[j]=b[j]-1;if(b[j]==-1){a+="</ul>"}}}a+="<hr>";a+="</ul>";RIOindexElem.innerHTML=a}function RioGenerateAndSaveXML(d,e){var b=document.implementation.createDocument("","",null);newriouploadtag=b.createElement("rioupload");b.appendChild(newriouploadtag);newrioheadertag=b.createElement("rioheader");newriouploadtag.appendChild(newrioheadertag);newfiletag=b.createElement("file");newfiletagcontent=b.createTextNode(d);newfiletag.appendChild(newfiletagcontent);newrioheadertag.appendChild(newfiletag);newriobodytag=b.createElement("riobody");newriobodytag.appendChild(RIOxmlIndex.importNode(e.documentElement,true));newriouploadtag.appendChild(newriobodytag);var a=new XMLSerializer().serializeToString(b);savingMsg();RIOSendXmlDataToServer(a,RIOuploadxmlPath)}function RIOtimeToStr(b){hours=parseInt(b/3600)%24;minutes=parseInt(b/60)%60;seconds=Math.round(b%60);if(hours==0){var a=(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)}else{var a=(hours<10?"0"+hours:hours)+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)}return a}function RIOConvertTime(a){var b=a.split(":");if((b.length<2)||(b.length>3)){alert("Formato inválido no tempo: ".timestr);return -1}if(b.length==3){return parseInt(b[0])*3600+parseInt(b[1])*60+parseInt(b[2])}else{return parseInt(b[0])*60+parseInt(b[1])}}function RIOTopickeydown(a,b){if(event.which==13){event.preventDefault();RIOvideoElem.focus()}}function RIOAddTopic(d,e){var f=parseInt(RIOvideoElem.currentTime);if(e){PosNextElement=d+1;ParentElement=RIOxmlIndex.getElementsByTagName("ind_item")[d]}else{PosNextElement=d+RIOxmlIndex.getElementsByTagName("ind_item")[d].getElementsByTagName("ind_item").length+1;ParentElement=RIOxmlIndex.getElementsByTagName("ind_item")[d].parentNode}if(PosNextElement>0){var b=parseInt(RIOxmlIndex.getElementsByTagName("ind_item")[PosNextElement-1].getElementsByTagName("time")[0].childNodes[0].nodeValue)+1}else{var b=0}if(PosNextElement<RIOxmlIndex.getElementsByTagName("ind_item").length){var a=parseInt(RIOxmlIndex.getElementsByTagName("ind_item")[PosNextElement].getElementsByTagName("time")[0].childNodes[0].nodeValue)-1}else{var a=RIOvideoElem.duration}if((f<b)||(f>a)){alert("O tempo atual do vídeo "+RIOtimeToStr(f)+" não pode ser usado pois deve estar entre "+RIOtimeToStr(b)+" e "+RIOtimeToStr(a)+"!");return}newind_item=RIOxmlIndex.createElement("ind_item");newtime=RIOxmlIndex.createElement("time");newtimetagcontent=RIOxmlIndex.createTextNode(f);newtime.appendChild(newtimetagcontent);newtext=RIOxmlIndex.createElement("text");newtexttagcontent=RIOxmlIndex.createTextNode("Novo tópico");newtext.appendChild(newtexttagcontent);newind_item.appendChild(newtime);newind_item.appendChild(newtext);if((PosNextElement<RIOxmlIndex.getElementsByTagName("ind_item").length)&&(RIOxmlIndex.getElementsByTagName("ind_item")[PosNextElement].parentNode==ParentElement)){ParentElement.insertBefore(newind_item,RIOxmlIndex.getElementsByTagName("ind_item")[PosNextElement]);PosNewTopic=PosNextElement}else{ParentElement.appendChild(newind_item);PosNewTopic=RIOxmlIndex.getElementsByTagName("ind_item").length-1}RIOdebug("RIOAddTopic: Gerenerating Index using function RIOloadIndex()");RIOloadIndex();RioGenerateAndSaveXML(RIOindexFileRIO,RIOxmlIndex);RIOxmlIndex.getElementsByTagName("ind_item")[PosNewTopic].focus();RIOgotoIndex(PosNewTopic)}function RIORemoveTopic(b){if(b==0){alert("O tópico raiz não pode ser removido!");return}if(RIOxmlIndex.getElementsByTagName("ind_item")[b].getElementsByTagName("ind_item").length==0){var d="Deseja realmente remover esse tópico?"}else{var d="Deseja realmente remover esse tópico e todos os seus sub-tópicos?"}if(!confirm(d)){return}var a=RIOxmlIndex.getElementsByTagName("ind_item")[b];if(a.parentNode!=null){a.parentNode.removeChild(a)}else{RIOxmlIndex.removeChild(a)}RIOdebug("RIORemoveTopic: Gerenerating Index using function RIOloadIndex()");RIOloadIndex();RioGenerateAndSaveXML(RIOindexFileRIO,RIOxmlIndex)}function RIOSaveIndex(e,f){var g=e.value;var b=g.indexOf(": ");if(b==-1){alert("Formato inválido no índice!");RIOdebug("RIOAddTopic: Gerenerating Index using function RIOloadIndex()");RIOloadIndex();return}var h=RIOConvertTime(g.substring(0,b));if(h==-1){alert("Formato inválido no tempo do índice!");RIOdebug("RIOAddTopic: Gerenerating Index using function RIOloadIndex()");RIOloadIndex();return}var k=g.substring(b+2);if(f>0){var d=parseInt(RIOxmlIndex.getElementsByTagName("ind_item")[f-1].getElementsByTagName("time")[0].childNodes[0].nodeValue)+1}else{var d=0}if(f!=(RIOxmlIndex.getElementsByTagName("ind_item").length-1)){var a=parseInt(RIOxmlIndex.getElementsByTagName("ind_item")[f+1].getElementsByTagName("time")[0].childNodes[0].nodeValue)-1}else{var a=RIOvideoElem.duration}if((h<d)||(h>a)){alert("Tempo inválido! O tempo deve estar entre "+RIOtimeToStr(d)+" e "+RIOtimeToStr(a)+"!");RIOdebug("RIOAddTopic: Gerenerating Index using function RIOloadIndex()");RIOloadIndex();return}if((RIOxmlIndex.getElementsByTagName("ind_item")[f].getElementsByTagName("text")[0].childNodes[0].nodeValue!=k)||(RIOxmlIndex.getElementsByTagName("ind_item")[f].getElementsByTagName("time")[0].childNodes[0].nodeValue!=h)){RIOxmlIndex.getElementsByTagName("ind_item")[f].getElementsByTagName("text")[0].childNodes[0].nodeValue=k;RIOxmlIndex.getElementsByTagName("ind_item")[f].getElementsByTagName("time")[0].childNodes[0].nodeValue=h;RioGenerateAndSaveXML(RIOindexFileRIO,RIOxmlIndex)}}function RIOgetIndex(b){var f=RIOxmlIndex.getElementsByTagName("ind_item")[b].getElementsByTagName("time")[0].childNodes[0].nodeValue;var d=RIOxmlIndex.getElementsByTagName("ind_item")[b].getElementsByTagName("text")[0].childNodes[0].nodeValue;child=RIOxmlIndex.getElementsByTagName("ind_item")[b];var e=RIOtimeToStr(f);if(RIOEdit=="true"){var a='<div style="display: inline-block;width: 100%;">';a+='<div style="display: inline-block;width: 70%;">';a+="<li onclick=\"makeInputEditable( 'index"+(b+1)+"' );\">";a+='<input id="index'+(b+1)+'" class="input-topic" type="text" value="'+e+": "+d+'" onblur="RIOSaveIndex( this, '+b+' );" onkeydown="RIOTopickeydown( this, '+b+' );">';a+="</li>";a+="</div>";a+='<div style="display: inline-block;width: 20%;">';a+='<div style="display: inline-block;width: 25%;">';a+='<a href="javascript:RIORemoveTopic( '+b+' );"  title="Remover tópico">';a+='<img width="12px" height="auto" src="images/delete_topic.svg" alt="Remover tópico">';a+="</a>";a+="</div>";a+='<div style="display: inline-block;width: 25%;">';a+='<a href="javascript:RIOAddTopic( '+b+', false );" title="Adicionar tópico">';a+='<img width="12px" height="auto" src="images/add_sibling_topic.svg" alt="Adicionar tópico">';a+="</a>";a+="</div>";a+='<div style="display: inline-block;width: 25%;">';a+='<a href="javascript:RIOAddTopic( '+b+', true );" title="Adicionar subtópico">';a+='<img width="12px" height="auto" src="images/add_child_topic.svg" alt="Adicionar subtópico">';a+="</a>";a+="</div>";a+='<div style="display: inline-block;width: 25%;">';a+='<a href="javascript:RIOgotoIndex( '+b+');" title="Pular o vídeo para este tópico">';a+='<img width="12px" height="auto" src="images/jump.svg" alt="Pular o vídeo para o este tópico">';a+="</a>";a+="</div>";a+="</div>";a+="</div>";return(a)}else{if(embedActive=="true"){return('<li style="cursor: default;" id="index'+(b+1)+'"><a style="display: block; color: #000000; padding: 10px; text-decoration: none;">'+e+": "+d+"</a></li>")}else{return('<li id="index'+(b+1)+'"><a href="javascript:RIOgotoIndex('+b+');">'+e+": "+d+"</a></li>")}}}function makeInputEditable(b){var d=document.getElementById(b);var a=d.value.length;d.focus();if(navigator.userAgent.indexOf("Firefox")!=-1){d.setSelectionRange(a,a)}}function RIOlike(b){var a=RIOsession_id+"*"+RIOgetDateTime()+"*"+b;RIOsendlog(a);RIOopinion="true";RIOloadtoolBar()}function RIOsendlog(a){if(RIOlocalAccess=="false"||RIOforceLog=="true"){RIOdebug("RIOsendlog: "+RIOurllog+a);RIOloadXMLDoc(RIOurllog+a,"true")}}function RIOgetDateTime(){Date.prototype.customFormat=function(g){var G,n,u,d,t,l,o,k,y,r,A,e,B,C,w,x,q,p,F,b,f,v;var E=this;n=((G=E.getFullYear())+"").slice(-2);t=(l=E.getMonth()+1)<10?("0"+l):l;d=(u=["January","February","March","April","May","June","July","August","September","October","November","December"][l-1]).substring(0,3);y=(r=E.getDate())<10?("0"+r):r;k=(o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][E.getDay()]).substring(0,3);f=(r>=10&&r<=20)?"th":((b=r%10)==1)?"st":(b==2)?"nd":(b==3)?"rd":"th";g=g.replace("#YYYY#",G).replace("#YY#",n).replace("#MMMM#",u).replace("#MMM#",d).replace("#MM#",t).replace("#M#",l).replace("#DDDD#",o).replace("#DDD#",k).replace("#DD#",y).replace("#D#",r).replace("#th#",f);B=(A=E.getHours());if(B==0){B=24}if(B>12){B-=12}e=B<10?("0"+B):B;F=(p=A<12?"am":"pm").toUpperCase();C=(w=E.getMinutes())<10?("0"+w):w;x=(q=E.getSeconds())<10?("0"+q):q;ms_aux=E.getMilliseconds();v=(ms_aux<100&&ms_aux>=10)?("0"+ms_aux):(ms_aux<10)?("00"+ms_aux):ms_aux;return g.replace("#hhh#",A).replace("#hh#",e).replace("#h#",B).replace("#mm#",C).replace("#m#",w).replace("#ss#",x).replace("#s#",q).replace("#ampm#",p).replace("#AMPM#",F).replace("#ms#",v)};var a=new Date;return a.customFormat("#YYYY##MM##DD##hh##mm##ss##ms#")}function RIObuildSendLogStartMsg(){var a=RIOsession_id+"*"+RIOgetDateTime()+"*"+RIOpwdXmlFile+"*"+RIObrowser()+"*"+RIOlogVersion+"*"+RIOos+"*riohtmlclient";RIOsendlog(a)}function RIOvideoStatus(){var a;if(RIOvideoElem.ended){a="STOP"}else{if(RIOvideoElem.paused){a="PAUSE"}else{a="PLAY"}}return a}function RIObuildStatusLogMsg(b){var a=RIOsession_id+"*"+RIOgetDateTime()+"*"+b+"*"+RIOvideoStatus()+"*"+RIOvideoElem.currentTime+"*";if(RIOsyncFile!==null){a=a+RIOcurrent_slide+"*"}else{a=a+"-1*"}if(RIOindexFile!==null){a=a+RIOcurrent_topic+"*"+RIOxmlIndex.getElementsByTagName("ind_item")[(RIOcurrent_topic!=0)?(RIOcurrent_topic-1):0].getElementsByTagName("time")[0].childNodes[0].nodeValue+"*"}else{a=a+"-1*-1*"}if(RIOsyncFile!==null){a=a+String(RIOsyncCheckBox).toUpperCase()+"*"}else{a=a+"-*"}a=a+fullscreenMode();RIOsendlog(a)}function fullscreenMode(){var a;if(RIObrowser().substr(0,4)=="MSIE"){a="UNKNOWN"}else{if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.oFullscreenElement){a="FULLSCREENVIDEO"}else{a="REGULAR"}}return a}function RIObuildSendLog(d,g,a){var h;var e;if(d=="TOPIC_CHANGED"||d=="PROGRESSBAR_CHANGED"){h=d;d=-1;if((String(RIOsyncCheckBox).toUpperCase()=="FALSE")||(RIOindexFile===null)){e=-1;g=-1}else{e=RIOxmlIndex.getElementsByTagName("ind_item")[a].getElementsByTagName("time")[0].childNodes[0].nodeValue;g++}a++}else{h="SLIDE_CHANGED";if((String(RIOsyncCheckBox).toUpperCase()=="FALSE")||(RIOsyncFile===null)){e=-1;a=-1}else{e=RIOxmlSync.getElementsByTagName("slide")[g].attributes.getNamedItem("time").nodeValue;a++}g++}var f=-1;if(RIOindexFile!==null){if(RIOcurrent_topic==0){f=RIOxmlIndex.getElementsByTagName("ind_item")[RIOcurrent_topic].getElementsByTagName("time")[0].childNodes[0].nodeValue}else{f=RIOxmlIndex.getElementsByTagName("ind_item")[RIOcurrent_topic-1].getElementsByTagName("time")[0].childNodes[0].nodeValue}}var b=RIOsession_id+"*"+RIOgetDateTime()+"*"+h+"*"+RIOvideoStatus()+"*"+RIOvideoElem.currentTime+"*"+RIOcurrent_slide+"*"+RIOcurrent_topic+"*"+f+"*"+String(RIOsyncCheckBox).toUpperCase()+"*"+fullscreenMode()+"*"+e+"*"+g+"*"+a+"*"+d;RIOsendlog(b)}function RIOchangeSlide(a){var b;switch(a){case"FIRST":b=0;break;case"PREV":b=RIOcurrent_slide-2;break;case"NEXT":b=RIOcurrent_slide;break;case"LAST":b=RIOxmlSync.getElementsByTagName("slide").length-1;break}RIOdebug("RIOchangeSlide: pressed_but="+a);if(RIOindexFile!==null){RIObuildSendLog(a,b,RIOfindNewTopicIndex(RIOxmlSync.getElementsByTagName("slide")[b].attributes.getNamedItem("time").nodeValue))}else{RIObuildSendLog(a,b,-1)}if(RIOsyncCheckBox){RIOvideoElem.currentTime=RIOxmlSync.getElementsByTagName("slide")[b].attributes.getNamedItem("time").nodeValue}else{RIOloadSlide(b)}if(RIOindexFile!==null){document.getElementById("index"+(RIOfindNewTopicIndex(RIOvideoElem.currentTime)+1)).scrollIntoView(true)}}function RIOloadSlideBar(){RIOdebug("RIOloadSlideBar: Loading SlideBar slide="+RIOcurrent_slide);var b=document.getElementById("RIOslideBar");var a='<table class="RIOtableSlideBar"><tr>';if(RIOcurrent_slide!=1){a+='<td><img id="firstslide" class="bars" alt="Primeiro slide" title="Primeiro slide" onclick="RIOchangeSlide(\'FIRST\');" src="images/first.png"></td>';a+='<td><img id="prevslide" class="bars" alt="Slide anterior" title="Slide anterior" onclick="RIOchangeSlide(\'PREV\');" src="images/prev.png"></td>'}else{a+='<td><img id="firstslide" class="bars" alt="Primeiro slide" title="Primeiro slide" src="images/first.png"></td>';a+='<td><img id="prevslide" class="bars" alt="Slide anterior" title="Slide anterior" src="images/prev.png"></td>'}var d=RIOxmlSync.getElementsByTagName("slide").length;a+="<td><em>"+(RIOcurrent_slide<10?"0"+RIOcurrent_slide:RIOcurrent_slide)+" / "+(d<10?"0"+d:d)+"</em></td>";if(RIOcurrent_slide!=RIOxmlSync.getElementsByTagName("slide").length){a+='<td><img id="nextslide" class="bars" alt="Próximo slide" title="Próximo slide" onclick="RIOchangeSlide(\'NEXT\');" src="images/next.png"></td>';a+='<td><img id="lastslide" class="bars" alt="Último slide" title="Último slide" onclick="RIOchangeSlide(\'LAST\');" src="images/last.png"></td>'}else{a+='<td><img id="nextslide" class="bars" alt="Próximo slide" title="Próximo slide" src="images/next.png"></td>';a+='<td><img id="lastslide" class="bars" alt="Último slide" title="Último slide" src="images/last.png"></td>'}a+="</tr></table>";b.innerHTML=a}function RIOalternateVideoSlide(){var a;var b;RIOdebug("RIOalternateVideoSlide: Alternate");if(videoSlidePos==0){videoSlidePos=1;a="divvideo";b="RIOslides"}else{videoSlidePos=0;a="RIOslides";b="divvideo"}if(window.innerWidth>window.innerHeight){document.getElementById(a).style.top="7%";document.getElementById(a).style.left="34%";document.getElementById(a).style.height="86%";document.getElementById(a).style.width="66%";document.getElementById(b).style.top="7%";document.getElementById(b).style.left="0%";document.getElementById(b).style.height="40%";document.getElementById(b).style.width="34%"}else{document.getElementById(a).style.top="47%";document.getElementById(a).style.left="33%";document.getElementById(a).style.height="46%";document.getElementById(a).style.width="67%";document.getElementById(b).style.top="7%";document.getElementById(b).style.left="0%";document.getElementById(b).style.height="40%";document.getElementById(b).style.width="100%"}}function RIOToolBarkeydown(b,a){if(event.which==13){event.preventDefault();RIOvideoElem.focus()}}function RIORenameSlideFile(e,h){var b=true;for(z=0;z<listFiles.length;z++){if(listFiles[z]==h){b=false}}if(b==true){var a=h.match(/\S[^\.\/a-zA-Z0-9_-]/g);if(a!=null){alert("Novo nome "+h+" para o arquivo do slide não é válido!");return false}var d=RIObaseRIODir+"/"+e;var g=RIObaseRIODir+"/"+h;XMLmv=RIOloadXMLDoc(RIOcommandPath+"?command=mv&params="+d+","+g,false);sessionId=XMLmv.getElementsByTagName("rioexec_mv")[0].getElementsByTagName("sessionid")[0];if(sessionId.id==0){var f="Erro ao renomear o arquivo de "+oldname+" para "+newname+" devido ao(s) erro(s):\n\n";if(sessionId.getElementsByTagName("apacheerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("rioerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("systemerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}alert(f);return false}return true}else{return false}}function RIOChangeSlide(n,g){var h=false;var m=n;var o=(RIOcurrent_slide>0)?(RIOcurrent_slide-1):0;if(g=="time"){var k=m.value;var f=RIOConvertTime(k);if(f==-1){alert("Formato inválido no tempo do slide (1)!");m.value=RIOtimeToStr(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value);return}if(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value!=f){if((f<1)||(f>RIOvideoElem.duration)){alert("Tempo inválido! O tempo deve estar entre "+RIOtimeToStr(1)+" e "+RIOtimeToStr(RIOvideoElem.duration)+"!");m.value=RIOtimeToStr(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value);return}for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){if(i!=o){var b=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").value;if(RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action").length>0){var e=RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action")[RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action").length-1].attributes.getNamedItem("time").nodeValue}else{var e=b}if((f>=b)&&(f<=e)){alert("Tempo inválido, pois o tempo do slide "+(i+1)+" está entre "+RIOtimeToStr(b)+" e "+RIOtimeToStr(e)+"!");m.value=RIOtimeToStr(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value);return}}}h=true;var l=f-RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value;RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("time").value=f;for(i=0;i<RIOxmlSync.getElementsByTagName("slide")[o].getElementsByTagName("action").length;i++){RIOxmlSync.getElementsByTagName("slide")[o].getElementsByTagName("action")[i].attributes.getNamedItem("time").nodeValue=parseInt(RIOxmlSync.getElementsByTagName("slide")[o].getElementsByTagName("action")[i].attributes.getNamedItem("time").nodeValue)+l}var d=-1;var p=RIOxmlSync.getElementsByTagName("slide")[o];for(i=0;(i<RIOxmlSync.getElementsByTagName("slide").length)&&(d==-1);i++){if((i!=o)&&(RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").value>f)){d=i}}if(d==-1){RIOxmlSync.getElementsByTagName("slides")[0].appendChild(p.cloneNode(true));RIOxmlSync.getElementsByTagName("slides")[0].removeChild(p)}else{if(d!=(o+1)){RIOxmlSync.getElementsByTagName("slides")[0].insertBefore(p.cloneNode(true),RIOxmlSync.getElementsByTagName("slide")[d]);RIOxmlSync.getElementsByTagName("slides")[0].removeChild(p)}}RIObuildSlides();RIOinsertSlides();RIOloadSlides(f)}}else{if(g=="filename"){var a=m.value;if(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("relative_path").value!=a){if(RIORenameSlideFile(RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("relative_path").value,a)){h=true;RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("relative_path").value=a}else{m.value=RIOxmlSync.getElementsByTagName("slide")[o].attributes.getNamedItem("relative_path").value}}}else{alert("Operação "+g+" inválida executada ao tentar alterar o slide!")}}if(h){RioGenerateAndSaveXML(RIOsyncFileRIO,RIOxmlSync)}}function RIOChangeNewSlideName(d,b){var e=b.value;if(d!=e){if(!RIORenameSlideFile(d,e)){b.value=d}else{var a=false;for(i=0;(i<RIOxmlSync.getElementsByTagName("slide").length)&&(!a);i++){if(RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").value==d){RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").value=e;a=true}}if(a){RioGenerateAndSaveXML(RIOsyncFileRIO,RIOxmlSync)}}}}function RIOChangeNewSlideNamekeydown(){if(event.which==13){event.preventDefault();RIOvideoElem.focus()}}function RIOAddSlide(a){document.getElementById("RIONewSlide1").style.display="none";document.getElementById("RIONewSlide").style.display="none";var e=RIOxmlSync.createElement("slide");var f=parseInt(RIOvideoElem.currentTime);var d=document.createAttribute("time");d.value=f;var b=document.createAttribute("relative_path");b.value=a;e.setAttributeNode(d);e.setAttributeNode(b);slidepos=-1;for(i=0;(i<RIOxmlSync.getElementsByTagName("slide").length)&&(slidepos==-1);i++){if(RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").value>f){slidepos=i}}if(slidepos==-1){RIOxmlSync.getElementsByTagName("slides")[0].appendChild(e);slidepos=RIOxmlSync.getElementsByTagName("slide").length-1}else{RIOxmlSync.getElementsByTagName("slides")[0].insertBefore(e,RIOxmlSync.getElementsByTagName("slide")[slidepos])}RioGenerateAndSaveXML(RIOsyncFileRIO,RIOxmlSync);RIOdebug("RIOAddSlide: recriando os slides e suas barras");RIOloadSlideBar();RIOloadtoolBar();RIObuildSlides();RIOinsertSlides();RIOloadSlide(slidepos)}function RIORemoveSyncSlide(d){var b=RIOxmlSync.getElementsByTagName("slides")[0].getElementsByTagName("slide").length;var a="";for(var e=0;e<b;e++){if(RIOxmlSync.getElementsByTagName("slides")[0].getElementsByTagName("slide")[e].attributes.getNamedItem("relative_path").value==d){var f=RIOxmlSync.getElementsByTagName("slides")[0].getElementsByTagName("slide")[e];if(b!=0){a=RIOxmlSync.getElementsByTagName("slides")[0].getElementsByTagName("slide")[e-1].attributes.getNamedItem("time").value}}}if(f!=undefined){RIOxmlSync.getElementsByTagName("slides")[0].removeChild(f)}RioGenerateAndSaveXML(RIOsyncFileRIO,RIOxmlSync);RIOGallery();RIOloadSlideBar();RIObuildSlides();RIOinsertSlides();if(a!=""){RIOloadSlide(Number(a))}else{RIOloadSlide(0)}}function RIOStringtoXML(b){if(window.ActiveXObject){var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b)}else{var d=new DOMParser();var a=d.parseFromString(b,"text/xml")}return a}function uploadComplete(e){if(document.getElementById("RIOwait")!==null){document.getElementById("RIOwait").style.display="none"}var d=RIOStringtoXML(e.target.responseText);if(d.getElementsByTagName("RIOconvertvideoxml")[0].getElementsByTagName("status")[0].getElementsByTagName("id")[0].childNodes[0].nodeValue==0){alert(d.getElementsByTagName("RIOconvertvideoxml")[0].getElementsByTagName("status")[0].getElementsByTagName("description")[0].childNodes[0].nodeValue)}else{alert("Upload do arquivo "+document.getElementById("slide-link").className+" feito com sucesso!");if(RIOTest=="true"){var a=document.getElementById("slide-link").className;var b=a.split(".").pop();if((b==a)||(b.toLowerCase()!="pdf")){RIONewSlide()}else{}}else{RIOGallery()}}document.body.style.cursor="auto";document.getElementById("RIONewSlide").disabled=false}function RIOUploadSlide(){document.body.style.cursor="wait";if(document.getElementById("RIOwait")!==null){document.getElementById("RIOwait").style.display=""}var a=new FormData(document.getElementById("upload-slide"));var b=new XMLHttpRequest();b.addEventListener("load",uploadComplete,false);b.open("POST","riocomposerweb/upload.php",false);b.send(a)}function RIOUploadSlidePDF(){document.body.style.cursor="wait";if(document.getElementById("RIOwait")!==null){document.getElementById("RIOwait").style.display=""}var a=new FormData(document.getElementById("upload-slide-pdf"));var b=new XMLHttpRequest();b.addEventListener("load",uploadComplete,false);b.open("POST","riocomposerweb/upload.php",false);b.send(a)}function verify_accents(f){try{var d=f;var e=/[^a-z0-9|.|_|-]/gi;var b=d.replace(e,"");if(b==f){return true}else{return false}}catch(a){RIOdebug("RIOinit: err="+a.toString());console.log("RIOinit: err="+a.toString())}}function RIOSelectUploadSlide(e){var g=false;for(z=0;z<fList.length;z++){if(fList[z]==e.files[0].name){g=true}}var d=verifyThumb(RIOxmlDoc);var a=verify_accents(e.files[0].name);if(g==false&&a===true&&d!==e.files[0].name){document.getElementById("slide-link").className=e.files[0].name;document.getElementById("submit-slide").disabled=false;document.getElementById("slide-convert").disabled=false;RIOUploadSlide()}else{if(g==true&&d!==e.files[0].name){document.getElementById("messegeconfirm").style.display="inline-block";document.getElementById("messegeconfirm").getElementsByTagName("div")[0].innerHTML="";document.getElementById("messegeconfirm").getElementsByTagName("div")[0].innerHTML="Já existe um arquivo com o mesmo nome. Deseja atualizar o arquivo?";var f=document.getElementById("messegeconfirm").getElementsByTagName("div")[1].getElementsByTagName("input")[0];f.setAttribute("onclick","messegeAlert( 'slide', 0 );");var b=document.getElementById("messegeconfirm").getElementsByTagName("div")[1].getElementsByTagName("input")[1];b.setAttribute("onclick","messegeAlert( 'slide', 1 );");document.getElementById("RIONewSlide").style.display="none"}if(a===false){alert("Nome do arquivo inválido, escolha um arquivo com o nome sem caracteres especiais.")}if(d===e.files[0].name){alert("O arquivo tem o mesmo nome do thumbnail, caso queira atualizar o thumbnail utilize o RIOComposerweb, o contrario mude o nome do arquivo.")}}}function RIOSelectUploadSlidePDF(d){var f=false;for(z=0;z<listFiles.length;z++){if(listFiles[z]==d.files[0].name){f=true}}var a=verify_accents(d.files[0].name);if(f==false&&a===true){document.getElementById("slide-link-pdf").className=d.files[0].name;document.getElementById("submit-slide-pdf").disabled=false;document.getElementById("slide-convert-pdf").disabled=false;document.getElementById("messegeconfirm").style.display="inline-block";document.getElementById("messegeconfirm").getElementsByTagName("div")[0].innerHTML="";document.getElementById("messegeconfirm").getElementsByTagName("div")[0].innerHTML="O upload do pdf pode demorar algum tempo, você tem certeza que deseja fazer o upload desse arquivo?";var e=document.getElementById("messegeconfirm").getElementsByTagName("div")[1].getElementsByTagName("input")[0];e.setAttribute("onclick","messegeAlert( 'pdf', 0 );");var b=document.getElementById("messegeconfirm").getElementsByTagName("div")[1].getElementsByTagName("input")[1];b.setAttribute("onclick","messegeAlert( 'pdf', 1 );");document.getElementById("RIONewSlide").style.display="none"}else{if(f==true){alert("Já existe um arquivo com o mesmo nome. Escolha outro ou troquei o nome.")}if(a===false){alert("Nome do arquivo inválido, coloque um nome sem caracteres especiais.")}}}function messegeAlert(a,b){if(b===0&&a==="pdf"){RIOUploadSlidePDF();document.getElementById("RIONewSlide").style.display="inline-block";document.getElementById("messegeconfirm").style.display="none"}else{if(b===0&&a==="slide"){RIOUploadSlide();document.getElementById("RIONewSlide").style.display="inline-block";document.getElementById("messegeconfirm").style.display="none"}else{if(b===1){RIOGallery();document.getElementById("messegeconfirm").style.display="none"}}}}function RIOclosePopup(){document.getElementById("RIONewSlide1").style.display="none";document.getElementById("RIONewSlide").style.display="none"}function RIORemoveSelectedSlide(a){RIOxmlSync.getElementsByTagName("slides")[0].removeChild(RIOxmlSync.getElementsByTagName("slide")[a]);RIOcurrent_slide--;if(RIOcurrent_slide<0){RIOcurrent_slide=0}RioGenerateAndSaveXML(RIOsyncFileRIO,RIOxmlSync);RIOdebug("RIORemoveSlide: recriando os slides e suas barras");RIOloadSlideBar();RIOloadtoolBar();RIObuildSlides();RIOinsertSlides();RIOloadSlide((RIOcurrent_slide>0)?(RIOcurrent_slide-1):0)}function RIORemoveFile(d){var e=new Array();var b=0;for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){if(RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").nodeValue==d){e[b++]=i}}if(e.length==0){var g="Deseja realmente remover o arquivo "+d+"?"}else{if(e.length==1){var g="Deseja realmente remover o arquivo "+d+" e o slide "+(e[0]+1)+" associado ao arquivo?"}else{var g="Deseja realmente remover o arquivo "+d+" e os slides ";for(i=0;i<e.length;i++){g=g+(e[i]+1);if(i!=(e.length-1)){g=g+", "}}g=g+" associados ao arquivo?"}}if(confirm(g)){var a=RIObaseRIODir+"/"+d;XMLmv=RIOloadXMLDoc(RIOcommandPath+"?command=rm&params="+a,false);sessionId=XMLmv.getElementsByTagName("rioexec_rm")[0].getElementsByTagName("sessionid")[0];if(sessionId.id==0){var f="Erro ao remover o arquivo "+d+" devido ao(s) erro(s):\n\n";if(sessionId.getElementsByTagName("apacheerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("rioerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("systemerror").length!=0){f=f+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}alert(f);return false}if(e.length==0){for(i=e.length-1;i>=0;i--){RIORemoveSelectedSlide(e[i])}}RIORemoveSyncSlide(d)}return true}function RIOSaveNewSlide(e){var d=prompt("Nome do arquivo a ser salvo",RIOEditNewFileName);if(d!=null){RIOEditNewFileName=d;var b=RIObaseRIODir+"/"+RIOEditNewFileName;var a=(new DOMParser()).parseFromString(e,"text/html");StyleTag=a.createElement("style");StyleTagText=a.createTextNode("html, body{ height: 540px; width: 720px; }");StyleTag.appendChild(StyleTagText);a.getElementsByTagName("head")[0].appendChild(StyleTag);RioGenerateAndSaveXML(b,a)}}function RIOcloseNewSlide(){var a=document.getElementById("RIOCreateSlide");a.innerHTML="";a.style.display="none";document.getElementById("RIOCreateSlide1").style.display="none";this.xmllsback="none"}function fixHeightOfTheText(){var a=document.getElementById("RIOCreateSlide").clientHeight;return a-190}function fixWidthOfTheText(){var a=document.getElementById("RIOCreateSlide").clientWidth;return a+a}function RIOCreateSlide(d){RIOEditNewFileName="";if(d=="none"){d=this.xmllsback}var k=document.createElement("div");k.setAttribute("style","position: relative; z-index: 200; height: 5%; width: 99.9%; display: block; border: 1px solid gray; margin: 0px; padding: 0px; background: -webkit-gradient(linear, left top, left bottom, from(#e7e7e7), to(#b0b0b0)) repeat-X; background: -moz-linear-gradient(top, #e7e7e7, #b0b0b0) repeat-X;background: -ms-linear-gradient(top, #e7e7e7 0%, #b0b0b0 100%); background: -o-linear-gradient(top, #e7e7e7, #b0b0b0) repeat-X; cursor: pointer;");k.setAttribute("onClick","RIOcloseNewSlide()");var a=document.createElement("div");a.setAttribute("class","body-gallery");a.setAttribute("style","display: inline-block; height: 100%; width: 100%; overflow-x: auto; position: relative;");var m=document.createElement("textarea");m.setAttribute("class","text-area");m.setAttribute("style","display: inline-block;");var b=document.createElement("label");b.setAttribute("title","fechar criação de slides");b.setAttribute("style","font-size: x-large; font-weight: lighter; position: relative; left: 52%;");b.innerHTML="Editor HTML";var f=document.createElement("label");f.setAttribute("class","close-str");f.setAttribute("title","fechar criação de slides");f.setAttribute("style","float: right; position: relative; top: 25%; right: 1%; font-size: large; font-weight: lighter; cursor: pointer; color: rgba(0, 0, 0, 0.32);");f.innerHTML="X";var n=document.createElement("table");n.setAttribute("style","width: 100%");var o=document.createElement("tr");o.setAttribute("style","width: 100%");var h=document.createElement("td");h.setAttribute("style","width: 80%");var l=document.createElement("td");l.setAttribute("style","width: 20%");h.appendChild(b);l.appendChild(f);o.appendChild(h);o.appendChild(l);n.appendChild(o);k.appendChild(n);var e=document.getElementById("RIOCreateSlide");e.innerHTML="";e.appendChild(k);e.style.display="inline-block";document.getElementById("RIOCreateSlide1").style.display="inline-block";var g="tinymce.init({\n";g+='    id: "my_id",\n';g+='    selector:  "textarea",\n';g+='    theme:    "modern",\n';g+="    resize:   false,\n";g+='    width: "99.8%",\n';g+='    height: "'+fixHeightOfTheText()+'",\n';g+='    browser_spellcheck: "true",\n';g+="    save_enablewhendirty: true,\n";g+="    apply_source_formatting : true,\n";g+="    save_onsavecallback: function() { RIOSaveNewSlide( tinymce.activeEditor.getContent( ) );},\n\n";g+="    plugins: [\n";g+='        "advlist autolink lists link image charmap preview hr anchor pagebreak",\n';g+='        "searchreplace wordcount visualblocks visualchars code fullscreen",\n';g+='        "insertdatetime media nonbreaking save table contextmenu directionality",\n';g+='        "template paste textcolor save fullpage"\n';g+="    ],\n";g+='    theme_advanced_buttons3_add : "fullpage",\n';g+='    toolbar1: "save | insertfile undo redo | styleselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | forecolor backcolor",\n';g+='    toolbar2: "link image | preview media",\n';g+="    image_advtab: true,\n";g+="    templates: [\n";g+="       {title: 'Test template 1', content: 'Test 1'},\n";g+="       {title: 'Test template 2', content: 'Test 2'},\n";g+="       {title: 'Test template 3', content: '<b>Test 3</b>'},\n";g+="       {title: 'Test template 4', content: '<table><tr><td>1.1</td><td>1.2</td><td>1.3</td></tr><tr><td>2.1</td><td>2.2</td><td>2.3</td></tr><tr><td>3.1</td><td>3.2</td><td>3.3</td></tr></table>'},\n";g+="       {title: 'Test template 5', content: '<table><tr><td>1.1</td><td colspan=\"2\">1.23</td></tr><tr><td>2.1</td><td>2.2</td><td>2.3</td></tr><tr><td>3.1</td><td>3.2</td><td>3.3</td></tr></table>'}\n";g+="    ]\n";g+="});\n";EditorScript=document.createElement("script");EditorScript.type="text/javascript";EditorText=document.createTextNode(g);EditorScript.appendChild(EditorText);a.appendChild(EditorScript);a.appendChild(m);e.appendChild(a);this.xmllsback=d}function RIOGallery(){RIOvideoElem.pause();fList=[];XMLls=RIOloadXMLDoc(RIOcommandPath+"?command=ls&params="+RIObaseRIODir,false);sessionId=XMLls.getElementsByTagName("rioexec_ls")[0].getElementsByTagName("sessionid")[0];if(sessionId.id!=0){var u=document.getElementById("RIONewSlide");u.innerHTML="";var m=document.createElement("div");m.setAttribute("class","header-gallery");var g=document.createElement("div");g.setAttribute("class","body-gallery");g.setAttribute("style","display: inline-block;");var f=document.createElement("div");f.setAttribute("class","close-gallery");f.setAttribute("style","cursor: pointer; ");f.setAttribute("onClick","RIOclosePopup()");var n=document.createElement("label");n.setAttribute("class","close-str");n.innerHTML="X";f.appendChild(n);var h=document.createElement("div");h.setAttribute("class","time-slide");h.innerHTML='<h1><p class="paragraph gallery">Galeria de Slides</p></h1>';var l=document.createElement("div");l.setAttribute("class","footer-gallery");m.appendChild(h);m.appendChild(f);var b='<div class="RIOTableNewSlide" style="position: relative; left: 2%; height: 100%; width: 98%; display: table; margin-bottom: 2%;">';var q=0;var r=0;var a=0;for(i=0;i<XMLls.getElementsByTagName("file").length;i++){var t=XMLls.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;var v=t.lastIndexOf("/");if(v!=-1){var s=t.substr(v+1)}else{var s=t}var p=s.lastIndexOf(".");if(p!=-1){var e=s.substr(p+1)}else{var e=""}if(e.match(/^(gif|html|htm|jpg|jpeg|png|svg)$/i)!=null){var o=verifyThumb(RIOxmlDoc);if(o===s){fList.push(s)}if(o!=s){fList.push(s);a=1;if(q==0&&r==0){q=2;b=createFirstCellBtn(b,s,XMLls);b=createCell(b,s,XMLls)}else{if(q==0&&r==1){q=1;b=createFirstCell(b,s,XMLls)}else{if(q==1){q=2;b=createCell(b,s,XMLls)}else{if(q==2){q=0;r=1;b=createCell(b,s,XMLls);b+="</div>"}}}}}else{if(a==0&&XMLls.getElementsByTagName("file").length<8){b=createFirstCellBtn(b,s,XMLls);b+="</div>"}}}}b+="</table>";g.innerHTML=b;u.innerHTML="";u.appendChild(m);u.appendChild(g);u.appendChild(l);u.style.display="inline-block";document.getElementById("RIONewSlide1").style.display="inline-block";preResizeSlides(0)}else{var d="Erro ao listar o conteúdo do diretório "+RIOcommandPath+" devido ao(s) erro(s):\n\n";if(sessionId.getElementsByTagName("apacheerror").length!=0){d=d+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("rioerror").length!=0){d=d+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("systemerror").length!=0){d=d+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}alert(d)}}function createFirstCellBtn(b,a,d){b+='<div class="image-gallery-row">';b+='<div class="image-gallery" style="height: 100%;">';b+='<div class="top-image">';b+='<div class="top-title-image">';b+='<label class="title-image" title="Selecione uma opçã abaixo">Adicione um novo slide</label>';b+="</div>";b+='<div class="remove-image">';b+='<label class="x-remove-image" style="color: #b0b0b0;">_</label>';b+="</div>";b+="</div>";b+='<div style="position: relative; top: 0%; height: 92%; width: auto;">';b+='<div style="width: 95%; height: 50%;">';b+='<form id="upload-slide" style="height: 100%;">';b+='<iframe title="Adicione aqui os seus slides em HTML ou imagens." style="position: relative; width: 85%; cursor: pointer;" src="rioload.html?f='+RIOwebserver+'/images/add-slide.png"></iframe>';b+='<input title="Adicione aqui os seus slides em HTML ou imagens." id="slide-file" type="file" name="file" accept="image/, .gif,.html,.htm,.jpg,.jpeg,.png,.svg" style="position: absolute; top: 0; right: 0; width: 95%; height: 100%; left: 0%; text-align: right; filter: alpha(opacity=0); opacity: 0; outline: none; background: white; cursor: inherit; display: block; cursor: pointer;" onchange="RIOSelectUploadSlide( this );"/ >';b+='<input id="slide-link" type="hidden" name="class" value="'+RIObaseRIODirAll+'">';b+='<input id="slide-convert" style="display: none;" type="checkbox" name="convertpdf" value="false" checked title="Converter o arquivo PDF para múltiplos arquivos JPG" disabled>';b+="</input>";b+='<input id="submit-slide" style="position: relative; left: 35%; display: none;" type="button" value="Upload" onclick="RIOUploadSlide();" disabled/>';b+="</form>";b+="</div>";if(RIOTest=="true"){b+='<div style="width: 100%; height: 30%;">';b+='<iframe style="position: relative; left: 3%; width: 65%; cursor: pointer;" src="rioload.html?f='+RIOwebserver+'/images/create-slide.png"></iframe>';b+='<input type="button" style="position: relative; width: 96%; height: 30%; border: none; cursor: pointer; position: absolute; top: 29%; right: 5%; filter: alpha(opacity=0); opacity: 0; cursor: pointer;" onclick="RIOCreateSlide( XMLls );" title="Criar um slide" />';b+="</div>"}b+='<div style="width: 100%; height: 50%; position: relative;">';b+='<form id="upload-slide-pdf" style="height: 100%;">';b+='<iframe title="Adicione aqui os seus slides usando um PDF, o RIOComposerweb irá convertê-los." style="width: 90%; cursor: pointer;" src="rioload.html?f='+RIOwebserver+'/images/add-slide-pdf.png"></iframe>';b+='<input title="Adicione aqui os seus slides usando um PDF, o RIOComposerweb irá convertê-los." id="slide-file-pdf" type="file" name="file" accept="image/, .pdf" style="filter: alpha(opacity=0); position: absolute; top: 0; right: 0; width: 95%; height: 100%; left: 0%; text-align: right; filter: alpha(opacity=0); opacity: 0;   outline: none; background: white; cursor: inherit; display: block; cursor: pointer;" onchange="RIOSelectUploadSlidePDF( this );"/ >';b+='<input id="slide-link-pdf" type="hidden" name="class" value="'+RIObaseRIODirAll+'">';b+='<input id="slide-convert-pdf" style="display: none;" type="checkbox" name="convertpdf" value="true" checked title="Converter o arquivo PDF para múltiplos arquivos JPG" disabled>';b+="</input>";b+='<input id="submit-slide-pdf" style="position: relative; left: 35%; display: none;" type="button" value="Upload" onclick="RIOUploadSlidePDF();" disabled/>';b+="</form>";b+="</div>";b+="</div>";b+="</div>";return b}function createFirstCell(b,a,d){b+='<div class="image-gallery-row">';b+='<div class="image-gallery">';b+='<div class="top-image">';b+='<div class="top-title-image">';b+='<input id="'+a+'" class="title-image" onclick="makeInputEditable(  \''+a+'\' )" onkeydown="RIOChangeNewSlideNamekeydown()" onblur="RIOChangeNewSlideName( \''+a+'\', this );" value="'+a+'">';b+="</div>";b+='<div class="remove-image" onclick="RIORemoveFile(\''+a+"' )\">";b+='<label class="x-remove-image">X</label>';b+="</div>";b+="</div>";b+='<div style="height: 100%; width: auto;">';var e=d.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;if((e.indexOf(".html")!=-1)||(e.indexOf(".htm")!=-1)){b+='<div class="iframeBlocker gallery">';b+="</div>";b+='<iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+e+'" class="image-file" style="width: 95%;">';b+="</iframe>";b+="</div>"}else{b+='<div class="iframeBlocker gallery">';b+="</div>";b+='<iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+e+'" class="image-file">';b+="</iframe>";b+="</div>"}b+="</div>";return b}function createCell(b,a,d){b+='<div class="image-gallery">';b+='<div class="top-image">';b+='<div class="top-title-image">';b+='<input id="'+a+'" class="title-image" onclick="makeInputEditable(  \''+a+'\' )" onkeydown="RIOChangeNewSlideNamekeydown()" onblur="RIOChangeNewSlideName( \''+a+'\', this );" value="'+a+'">';b+="</div>";b+='<div class="remove-image" onclick="RIORemoveFile(\''+a+"' )\">";b+='<label class="x-remove-image">X</label>';b+="</div>";b+="</div>";b+='<div style="height: 100%; width: auto;">';var e=d.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;if((e.indexOf(".html")!=-1)||(e.indexOf(".htm")!=-1)){b+='<div class="iframeBlocker gallery">';b+="</div>";b+='<iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+e+'" class="image-file" >';b+="</iframe>";b+="</div>"}else{b+='<div class="iframeBlocker gallery">';b+="</div>";b+='<iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+e+'" class="image-file" >';b+="</iframe>";b+="</div>"}b+="</div>";return b}function RIONewSlide(){RIOvideoElem.pause();fList=[];var w=parseInt(RIOvideoElem.currentTime);for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){var g=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").value;if(RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action").length>0){var v=RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action")[RIOxmlSync.getElementsByTagName("slide")[i].getElementsByTagName("action").length-1].attributes.getNamedItem("time").nodeValue}else{var v=g}if((w>=g)&&(w<=v)){alert("Tempo inválido, pois o tempo do slide "+(i+1)+" está entre "+RIOtimeToStr(g)+" e "+RIOtimeToStr(v)+"!");return}}XMLls=RIOloadXMLDoc(RIOcommandPath+"?command=ls&params="+RIObaseRIODir,false);sessionId=XMLls.getElementsByTagName("rioexec_ls")[0].getElementsByTagName("sessionid")[0];if(sessionId.id!=0){var x=document.getElementById("RIONewSlide");x.innerHTML="";var m=document.createElement("div");m.setAttribute("class","header-gallery");var f=document.createElement("div");f.setAttribute("class","body-gallery");f.setAttribute("style","display: inline-block;");var e=document.createElement("div");e.setAttribute("class","close-gallery");e.setAttribute("style","cursor: pointer; ");e.setAttribute("onClick","RIOclosePopup()");var n=document.createElement("label");n.setAttribute("class","close-str");n.innerHTML="X";e.appendChild(n);var h=document.createElement("div");h.setAttribute("class","time-slide");h.innerHTML='<h1><p class="paragraph"> Selecione o slide que aparecerá em : '+RIOtimeToStr(w)+"</p></h1>";var l=document.createElement("div");l.setAttribute("class","footer-gallery");m.appendChild(h);m.appendChild(e);var a='<div class="RIOTableSlide" style="position: relative; left: 2%; height: 100%; width: 98%; display: table; margin-bottom: 2%;">';var q=0;var r=0;for(i=0;i<XMLls.getElementsByTagName("file").length;i++){var t=XMLls.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;var y=t.lastIndexOf("/");if(y!=-1){var s=t.substr(y+1)}else{var s=t}var p=s.lastIndexOf(".");if(p!=-1){var d=s.substr(p+1)}else{var d=""}if(d.match(/^(gif|html|htm|jpg|jpeg|png|svg)$/i)!=null){var o=verifyThumb(RIOxmlDoc);if(o===s){fList.push(s)}if(o!=s){fList.push(s);if(q==0){q=1;a+='<div class="image-gallery-row">';a+='<div class="image-gallery">';a+='<div class="top-image">';a+='<div class="top-title-image">';a+='<label class="title-image"><p onclick="RIOAddSlide(\''+s+"')\">"+s+"</p></label>";a+="</div>";if(RIOxmlSync.getElementsByTagName("slide").length>1){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{if(RIOxmlSync.getElementsByTagName("slide").length===1){if(RIOxmlSync.getElementsByTagName("slide")[0].attributes.getNamedItem("relative_path").value!==s){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{a+='<div class="remove-image" style="cursor: default;">';a+='<label class="x-remove-image"></label>';a+="</div>"}}}a+="</div>";a+='<div style="height: 100%; width: auto;">';var u=XMLls.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;if((u.indexOf(".html")!=-1)||(u.indexOf(".htm")!=-1)){a+='<div class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file" >';a+="</iframe></div>"}else{a+='<div title="Dê um click no título da imagem ou na imagem para adicionar o slide" class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file"> </iframe>';a+="</div>"}a+="</div>"}else{if(q==1){q=2;a+='<div class="image-gallery">';a+='<div class="top-image">';a+='<div class="top-title-image">';a+='<label class="title-image"><p onclick="RIOAddSlide(\''+s+"')\">"+s+"</p></label>";a+="</div>";if(RIOxmlSync.getElementsByTagName("slide").length>1){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{if(RIOxmlSync.getElementsByTagName("slide").length===1){if(RIOxmlSync.getElementsByTagName("slide")[0].attributes.getNamedItem("relative_path").value!==s){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{a+='<div class="remove-image" style="cursor: default;">';a+='<label class="x-remove-image"></label>';a+="</div>"}}}a+="</div>";a+='<div style="height: 100%; width: auto;">';var u=XMLls.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;if((u.indexOf(".html")!=-1)||(u.indexOf(".htm")!=-1)){a+='<div title="Dê um click no título da imagem ou na imagem para adicionar o slide" class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file" >';a+="</iframe></div>"}else{a+='<div title="Dê um click no título da imagem ou na imagem para adicionar o slide" class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file"> </iframe>';a+="</div>"}a+="</div>"}else{if(q==2){q=0;a+='<div class="image-gallery">';a+='<div class="top-image">';a+='<div class="top-title-image">';a+='<label class="title-image"><p onclick="RIOAddSlide(\''+s+"')\">"+s+"</p></label>";a+="</div>";if(RIOxmlSync.getElementsByTagName("slide").length>1){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{if(RIOxmlSync.getElementsByTagName("slide").length===1){if(RIOxmlSync.getElementsByTagName("slide")[0].attributes.getNamedItem("relative_path").value!==s){a+='<div class="remove-image">';a+='<label class="x-remove-image"></label>';a+="</div>"}else{a+='<div class="remove-image" style="cursor: default;">';a+='<label class="x-remove-image"></label>';a+="</div>"}}}a+="</div>";a+='<div style="height: 100%; width: auto;">';var u=XMLls.getElementsByTagName("file")[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;if((u.indexOf(".html")!=-1)||(u.indexOf(".htm")!=-1)){a+='<div title="Dê um click no título da imagem ou na imagem para adicionar o slide" class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file" >';a+="</iframe></div>"}else{a+='<div title="Dê um click no título da imagem ou na imagem para adicionar o slide" class="iframeBlocker" onclick="RIOAddSlide(\''+s+'\');"></div><iframe width="100px" height="100px" frameborder="0" src="'+RIOwebserver+"/rioload.html?f="+RIOwebserver+"/riotransfer"+u+'" class="image-file" > </iframe>';a+="</div>"}a+="</div>";a+="</div>"}}}}}}a+="</table>";f.innerHTML=a;x.innerHTML="";x.appendChild(m);x.appendChild(f);x.appendChild(l);x.style.display="inline-block";document.getElementById("RIONewSlide1").style.display="inline-block";preResizeSlides(1)}else{var b="Erro ao listar o conteúdo do diretório "+RIOcommandPath+" devido ao(s) erro(s):\n\n";if(sessionId.getElementsByTagName("apacheerror").length!=0){b=b+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("rioerror").length!=0){b=b+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}if(sessionId.getElementsByTagName("systemerror").length!=0){b=b+"-"+sessionId.getElementsByTagName("rioerror")[0].childNodes[0].nodeValue+"\n"}alert(b)}}function RIORemoveSlide(){if(confirm("Realmente deseja remover o slide atual?")){var a=(RIOcurrent_slide>0)?(RIOcurrent_slide-1):0;if(RIOxmlSync.getElementsByTagName("slide").length==1){alert("Não é possível remover esta sincronização, a videoaula deve conter pelo menos um slide.")}else{RIORemoveSelectedSlide(a)}}}function RIOSlidesChangeGetFocus(){RIOvideoElem.pause()}function RIOloadtoolBar(){RIOdebug("RIOloadtoolBar: Loading ToolBar slide="+RIOcurrent_slide);var b=document.getElementById("RIOtoolBar");var d='<table class="RIOtableSlideBar" style="width = 95%;"><tr>';if(RIOEdit=="false"){if(RIOsyncCheckBox){d+='<td style="width: 85%"><em>Sincronizar</em><input id="sync" type="checkbox" name="sync" value="sync" onclick="RIOonSyncClick();" checked></td>';d+='<td style="width: 15%">';d+='<iframe id="creativeImage" class="bars" src="rioload.html?f='+RIOwebserver+'/images/copyright.png" style="cursor: pointer; float: right; height: 20%; width: 60%; margin-top: 15%;" onload="iframeClickCreative();"></iframe>';d+='<div onclick="ballonRights();" id="tooltip-rights" style="display: none;" >';d+='<ul class="rigths-tooltip">';d+='<li id="li-rigths-rules"></li>';d+="</ul>";d+="</div>";d+="</td>"}else{d+='<td style="width: 85%"><em>Sincronizar</em><input id="sync" type="checkbox" name="sync" value="sync" onclick="RIOonSyncClick();"></td>';d+='<td style="width: 15%">';d+='<iframe id="creativeImage" class="bars" src="rioload.html?f='+RIOwebserver+'/images/copyright.png" style="cursor: pointer; float: right; height: 20%; width: 60%; margin-top: 15%;" onload="iframeClickCreative();"></iframe>';d+='<div onclick="ballonRights();" id="tooltip-rights" style="display: none;">';d+='<ul class="rigths-tooltip">';d+='<li id="li-rigths-rules" ></li>';d+="</ul>";d+="</div>";d+="</td>"}}if(RIOEdit=="true"){var a=(RIOcurrent_slide>0)?(RIOcurrent_slide-1):0;d+='<td style="width: 15%;">';d+='<input id="barTime" onclick="makeInputEditable( this.id )" onfocus="RIOSlidesChangeGetFocus();" onkeydown="RIOToolBarkeydown( this, \'time\' );" onblur="RIOChangeSlide( this, \'time\');" style="background-color: white; border: 1px solid rgb(138, 138, 138); margin: 0px 0px 0px 0px; width: 100%; min-width: 55px; max-width: 70; height: 50%; text-align:center;" value="'+RIOtimeToStr(RIOxmlSync.getElementsByTagName("slide")[a].attributes.getNamedItem("time").value)+'" >';d+="</td>";d+='<td style="width: 65%;">';d+='<p id="slide-name" title="nome do slide" style="position: relative; bottom: 5px; width: 100%;">';d+='<label style="position: relative; top: 10%; font-size: 90%; width: 100%; white-space: nowrap;">'+RIOxmlSync.getElementsByTagName("slide")[a].attributes.getNamedItem("relative_path").value+"</label>";d+="</p>";d+="</td>";d+='<td style="width: 6%;"><a onfocus="RIOSlidesChangeGetFocus();" onclick="RIOGallery();"><img height="auto" src="images/gallery-2.png" class="btn-gallery-slide" title="Abrir Galeria" style="width: 100%; cursor: pointer; min-width: 26px;"></a></td>';d+='<td style="width: 6%;"><a onfocus="RIOSlidesChangeGetFocus();" onclick="RIONewSlide();"><img height="auto" src="images/add_slide.svg" class="btn-add-slide" title="Sincronizar Slides"></a></td>';d+='<td style="width: 6%;"><a onfocus="RIOSlidesChangeGetFocus();" onclick="RIORemoveSlide();"><img height="auto" src="images/delete_slide.svg" class="btn-delete-slide" title="Remover a sincronização do slide atual"></a></td>'}d+="</tbody></tr></table>";b.innerHTML=d}function RIOonSyncClick(){RIOsyncCheckBox=document.getElementById("sync").checked;RIOdebug("RIOonSyncClick: Sync="+RIOsyncCheckBox);RIObuildStatusLogMsg("SYNC")}function RIOloadSlide(a){var b=a;RIOcurrent_slide=b+1;RIOdebug("RIOloadSlide: local_i="+b);RIOdebug("RIOloadSlide: loading slide="+RIOcurrent_slide);for(j=1;j<=RIOxmlSync.getElementsByTagName("slide").length;j++){if(j!=RIOcurrent_slide){document.getElementById("slide"+j).className="hide"}}document.getElementById("slide"+RIOcurrent_slide).className="div.RIOslides";RIOcurrent_action=-1;RIOloadSlideBar();RIOloadtoolBar()}function RIOloadAction(currentTime){var prev_RIOcurrent_slide=(RIOcurrent_slide!=0)?(RIOcurrent_slide-1):0;var slide_name=RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].attributes.getNamedItem("relative_path").nodeValue;for(j=0;j<RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action").length;j++){if((RIOcurrent_action!=j)&&(currentTime>=RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action")[j].attributes.getNamedItem("time").nodeValue)&&((j==(RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action").length-1))||(currentTime<RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action")[j+1].attributes.getNamedItem("time").nodeValue))){if(RIOlocalAccess=="true"){var action='document.getElementById("slide'+RIOcurrent_slide+'").contentWindow.execAction("'+RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action")[j].childNodes[0].nodeValue+'")'}else{var action='document.getElementById("slide'+RIOcurrent_slide+'").contentWindow.postMessage("'+RIOxmlSync.getElementsByTagName("slide")[prev_RIOcurrent_slide].getElementsByTagName("action")[j].childNodes[0].nodeValue+'","'+RIOwebserver+'")'}eval(action);RIOcurrent_action=j;RIOdebug("RIOloadAction: slide="+RIOcurrent_slide+" action="+j)}}}function RIOloadSlides(a){if(RIOsyncCheckBox){for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){if(i==(RIOxmlSync.getElementsByTagName("slide").length-1)){if(a>=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").nodeValue){if(RIOcurrent_slide!=(i+1)){RIOloadSlide(i)}else{RIOloadAction(a)}}}else{if((a>=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("time").nodeValue&&a<RIOxmlSync.getElementsByTagName("slide")[i+1].attributes.getNamedItem("time").nodeValue)){if(RIOcurrent_slide!=(i+1)){RIOloadSlide(i)}else{RIOloadAction(a)}break}}}}}function RIOupdateCurrentTopic(a){for(i=0;i<RIOxmlIndex.getElementsByTagName("ind_item").length;i++){if(i==(RIOxmlIndex.getElementsByTagName("ind_item").length-1)){if(a>RIOxmlIndex.getElementsByTagName("ind_item")[i].getElementsByTagName("time")[0].childNodes[0].nodeValue&&RIOcurrent_topic!=(i+1)){if(RIOcurrent_topic!=0){document.getElementById("index"+RIOcurrent_topic).style.background="#FFFFFF"}RIOcurrent_topic=i+1;document.getElementById("index"+RIOcurrent_topic).style.background="#B6B6B4"}}else{if((a>=RIOxmlIndex.getElementsByTagName("ind_item")[i].getElementsByTagName("time")[0].childNodes[0].nodeValue&&a<RIOxmlIndex.getElementsByTagName("ind_item")[i+1].getElementsByTagName("time")[0].childNodes[0].nodeValue)||a==0){if(RIOcurrent_topic!=(i+1)){if(RIOcurrent_topic==0){document.getElementById("index1").style.background="#FFFFFF"}else{document.getElementById("index"+RIOcurrent_topic).style.background="#FFFFFF"}RIOcurrent_topic=i+1;document.getElementById("index"+RIOcurrent_topic).style.background="#B6B6B4"}break}}}}function RIOinsertSlides(){for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){RIOdebug("RIOinsertSlide: Load Slide="+(i+1));document.getElementById("slide"+(i+1)).src=RIOloadUrl+RIOrelativeUrl+RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").value}}function scaleSizeImg(a){var b=window.innerWidth;var f=window.innerHeight;var e=a.style.width;var g=a.style.height;var d=g/e;if(e>=b&&d<=1){e=b;g=e*d}else{if(g>=f){g=f;e=g/d}}a.style.width=e;a.style.height=g}function RIObuildThumbnail(){var a;var d="";RIOdebug("RIObuildThumbnail: Loading slides");if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail").length==1){for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry").length;i++){var b=document.getElementById("slide"+(i+1));if(b!=null){b.parentNode.removeChild(b)}}for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry").length;i++){RIOdebug("RIObuildThumbnail: Load Slide="+(i+1));a=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry")[i].childNodes[0].nodeValue;d+='<iframe id="slide'+(i+1)+'" src=""></iframe>'}}else{RIOdebug("RIObuildThumbnail: Load Slide="+1);a="videoaula.jpg";d+='<iframe id="slide'+1+'" src=""></iframe>'}RIOslidesElem.innerHTML=d}function RIOinsertThumbnail(){if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail").length==1){for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry").length;i++){RIOdebug("RIOinsertSlide: Load Slide="+(i+1));document.getElementById("slide"+(i+1)).src=RIOloadUrl+RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry")[i].childNodes[0].nodeValue}}else{var a=RIOloadUrl;if(RIOloadUrl.indexOf("https")!=-1){a=a.replace("https","http")}document.getElementById("slide1").src=a+RIOwebserver+"/images/videoaula.jpg"}scaleSizeImg(document.getElementById("slide1"))}function RIObuildSlides(){var a;var d="";RIOdebug("RIObuildSlides: Loading slides");for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){var b=document.getElementById("slide"+(i+1));if(b!=null){b.parentNode.removeChild(b)}}for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){RIOdebug("RIObuildSlides: Load Slide="+(i+1));a=RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").value;d+='<iframe id="slide'+(i+1)+'" src=""></iframe>'}if(listFiles.length==0){for(c=0;c<RIOxmlSync.getElementsByTagName("slide").length;c++){listFiles[c]=RIOxmlSync.getElementsByTagName("slide")[c].attributes.getNamedItem("relative_path").value}}RIOslidesElem.innerHTML=d}function RIOprefetchSlides(){var a="";for(i=0;i<RIOxmlSync.getElementsByTagName("slide").length;i++){RIOdebug("RIOprefetchSlides: Prefetch Slide="+(i+1));a+='<link rel="prefetch" href="'+RIOrelativeUrl+RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").nodeValue+'">';a+='<link rel="prerender" href="'+RIOrelativeUrl+RIOxmlSync.getElementsByTagName("slide")[i].attributes.getNamedItem("relative_path").nodeValue+'">'}document.getElementById("RIOhead").innerHTML+=a}function RIOTimeOut(){var a=RIOloadXMLDoc(RIOcommandPath+"?command=ls&params="+RIObaseRIODir,false)}function RIOinit(d,b,k,q,w,a){embedActive=a;RIOStartVideos=true;RIOdebugControl();if(k=="true"){RIOenableDebug()}RIOos=RIOsetOS();RIOsession_id=RIOgetDateTime();RIOdebug("RIOinit: O.S.="+RIOos);RIOdebug("RIOinit: Browser="+RIObrowser());RIOdebug("RIOinit: xmlfile="+d);RIOslidesElem=document.getElementById("RIOslides");if(typeof(q)!=="undefined"){RIOEdit=q}else{RIOEdit="false"}if(typeof(w)!=="undefined"){RIOTest=w}else{RIOTest="false"}if(d.search("file:///")!=-1){RIOlocalAccess="true";RIOloadUrl="rioload.html?f=";RIOpwdXmlFile=d;RIOxmlfile=d}else{if(b=="false"){var m=RIOloadXMLDoc("serverredirect.rio","false");RIOwebserver=m.getElementsByTagName("rioserverredirect")[0].childNodes[0].nodeValue}else{RIOwebserver=location.protocol+"//"+location.host}RIOxmlfile=RIOwebserver+"/riotransfer"+d;RIOpwdXmlFile=RIOxmlfile.substr(RIOxmlfile.indexOf("/riotransfer")+12,RIOxmlfile.length);RIOloadUrl=RIOwebserver+"/rioload.html?f="}RIOrelativeUrl=RIOxmlfile.substr(0,RIOxmlfile.lastIndexOf("/"))+"/";RIOdebug("RIOinit: RIOlocalAccess="+RIOlocalAccess);RIOdebug("RIOinit: RIOloadUrl="+RIOloadUrl);RIOdebug("RIOinit: RIOpwdXmlFile="+d);RIOdebug("RIOinit: RIOxmlfile="+RIOxmlfile);RIOdebug("RIOinit: RIOwebserver="+RIOwebserver);RIOdebug("RIOinit: RIOrelativeUrl="+RIOrelativeUrl);RIOxmlDoc=RIOloadXMLDoc(RIOxmlfile,"false");try{RIOxmlTitle=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("general")[0].getElementsByTagName("title")[0].getElementsByTagName("string")[0].childNodes[0].nodeValue}catch(h){RIOdebug("RIOinit: err="+h.toString());xmlOldVersion="true"}RIOdebug("RIOinit: xmlOldVersion="+xmlOldVersion);if(xmlOldVersion=="false"){RIOxmlTitle=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("general")[0].getElementsByTagName("title")[0].getElementsByTagName("string")[0].childNodes[0].nodeValue;var s=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("lifecycle")[0].getElementsByTagName("contribute")[1].getElementsByTagName("entity")[0].childNodes[0].nodeValue;RIOxmlAuthor=s.substr(16,(s.length-27));RIOxmlCourse=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("educational")[0].getElementsByTagName("course")[0].getElementsByTagName("string")[0].childNodes[0].nodeValue;RIObaseRIODir=d.substr(0,d.lastIndexOf("/"));RIObaseRIODirAll=d;var v=0;for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia").length;i++){switch(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("catalog")[0].childNodes[0].nodeValue){case"index":RIOindexFile=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;RIOindexFileRIO=d.substr(0,d.lastIndexOf("/"))+"/"+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;break;case"sync":RIOsyncFile=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;RIOsyncFileRIO=d.substr(0,d.lastIndexOf("/"))+"/"+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;break;case"video":RIOvideoFile[v]=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;v++;break}}if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility").length>0){var x=0;if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("libras").length!==0){for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("libras")[0].getElementsByTagName("relatedmedia").length;i++){switch(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("libras")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("catalog")[0].childNodes[0].nodeValue){case"video":RIOLibrasFile[x]=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("libras")[0].getElementsByTagName("relatedmedia")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;x++;break}}}}}else{RIOxmlTitle=RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("obj_title")[0].childNodes[0].nodeValue;RIOxmlAuthor=RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("professor")[0].childNodes[0].nodeValue;RIOxmlCourse=RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("course")[0].childNodes[0].nodeValue;var v=0;for(i=0;i<RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("related_media")[0].getElementsByTagName("rm_item").length;i++){switch(RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("related_media")[0].getElementsByTagName("rm_item")[i].getElementsByTagName("rm_type")[0].childNodes[0].nodeValue){case"index":RIOindexFile=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("related_media")[0].getElementsByTagName("rm_item")[i].getElementsByTagName("rm_filename")[0].childNodes[0].nodeValue;break;case"sync":RIOsyncFile=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("related_media")[0].getElementsByTagName("rm_item")[i].getElementsByTagName("rm_filename")[0].childNodes[0].nodeValue;break;case"video":RIOvideoFile[v]=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("rio_object")[0].getElementsByTagName("related_media")[0].getElementsByTagName("rm_item")[i].getElementsByTagName("rm_filename")[0].childNodes[0].nodeValue;v++;break}}}RIOloadXmlFile();if(RIOindexFile!==null){RIOxmlIndex=RIOloadXMLDoc(RIOindexFile,"false")}if(RIOsyncFile!==null){RIOxmlSync=RIOloadXMLDoc(RIOsyncFile,"false")}loadSubtitles(a);var f=document.getElementById("divvideo");var o=document.getElementById("RIOslides");var e=document.getElementById("RIOslideBar");var g=document.getElementById("RIOtoolBar");var u=document.getElementById("index");if(a=="true"&&q=="false"){if(RIOsyncFile!==null){RIObuildThumbnail();RIOinsertThumbnail();document.getElementsByTagName("body")[0].style.display="inline-block"}else{RIObuildThumbnail();RIOinsertThumbnail();o.style.width="98.5%";u.style.display="none";var n=document.getElementById("indexTitle");n.style.display="none";if(o!==null&&e!==null&&g!==null){o.style.display="none";e.style.display="none";g.style.display="none"}RIOcurrent_slide=-1;document.getElementsByTagName("body")[0].style.display="inline-block"}if(RIOindexFile!==null){RIOloadIndex()}else{u.style.display="none";RIOcurrent_topic=-1}}else{if(RIOsyncFile===null){document.getElementsByTagName("body")[0].style.display="inline-block";f.style.height="93%";var l=document.getElementsByClassName("content-tools")[0];l.style.display="none";var t=document.getElementById("tools-bar");t.style.display="none";var r=document.getElementById("div-drag-resize");r.style.display="none";o.style.width="98.5%";u.style.display="none";if(RIOindexFile!==null){u.style.top=f.offsetTop+"px";u.style.left=f.offsetLeft+"px";f.style.top=o.offsetTop+"px";f.style.left=o.offsetLeft+"px";u.style.height=f.style.height;if(o.offsetWidth>e.offsetWidth){f.style.width=o.offsetWidth+"px"}else{f.style.width=e.offsetWidth+"px"}}else{f.style.width="100%"}o.style.display="none";e.style.display="none";g.style.display="none"}else{document.getElementsByTagName("body")[0].style.display="inline-block";RIOloadSlideBar();RIOloadtoolBar();RIObuildSlides();RIOinsertSlides()}if(RIOindexFile!==null){RIOloadIndex()}else{document.getElementById("index").style.display="none"}RIOloadVideo();if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0]!=undefined){RIOloadLibras()}RIOinitTemplates();RIObuildSendLogStartMsg();setInterval(RIOstateMsg,30000);setInterval(RIObufferVideoMsg,RIObufferVideoMsgInterval);if(RIOEdit=="true"){setInterval(RIOTimeOut,60000)}if(RIOTest=="true"){var p=document.getElementById("div-drag-resize");p.setAttribute("onmousedown","dragdrop( this, event )")}else{}window.onbeforeunload=function(){RIObuildStatusLogMsg("CLOSE")}}}function loadSubtitles(f){var b=false;var a;var e=0;RIOVideoSubtitlesDefaultIndex=-1;if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0]!==undefined){if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("subtitle")[0]!==undefined){for(i=0;i<RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("subtitle").length;i++){var d=RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("subtitle")[i];if(d.getElementsByTagName("standard").length>0){if(d.getElementsByTagName("standard")[0].childNodes[0].nodeValue=="true"){if(b){console.log("Aviso: a legenda do arquivo "+d.getElementsByTagName("entry")[0].childNodes[0].nodeValue+" não pode ser default, pois uma legenda anterior já foi definida como default. Ignorando a tag!");a=false}else{a=true;b=true}}else{a=false;if(d.getElementsByTagName("standard")[0].childNodes[0].nodeValue!="false"){console.log("Aviso: Entrada standard da legenda do arquivo "+d.getElementsByTagName("entry")[0].childNodes[0].nodeValue+" com o valor inválido "+d.getElementsByTagName("standard")[0].childNodes[0].nodeValue+" ignorada!")}}}else{a=false}RIOVideoSubtitlesFileName[e]=d.getElementsByTagName("entry")[0].childNodes[0].nodeValue;if(a){RIOVideoSubtitlesDefaultIndex=e}if(d.getElementsByTagName("description")[0].childNodes[0].nodeValue.length!==undefined){RIOVideoSubtitlesDescription[e]=d.getElementsByTagName("description")[0].childNodes[0].nodeValue}RIOVideoSubtitlesLanguage[e]=d.getElementsByTagName("language")[0].childNodes[0].nodeValue;e++;switch(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("subtitle")[i].getElementsByTagName("catalog")[0].childNodes[0].nodeValue){case"video":RIOLibrasFile[LibrasIndex]=RIOrelativeUrl+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("acessibility")[0].getElementsByTagName("subtitle")[i].getElementsByTagName("entry")[0].childNodes[0].nodeValue;LibrasIndex++;break}}}}if(f!=="true"){if(RIOVideoSubtitlesDefaultIndex!=-1){for(i=0;i<RIOVideoSubtitlesFileName.length;i++){if(RIOVideoSubtitlesDefaultIndex==i){RIOvideoElem=document.getElementById("RIOvideo");track=document.createElement("track");track.kind="subtitles";track.label=RIOVideoSubtitlesDescription[i];track.srclang=RIOVideoSubtitlesLanguage[i];track.src=RIOrelativeUrl+RIOVideoSubtitlesFileName[i];track.addEventListener("load",function(){this.mode="hidden";RIOvideoElem.textTracks[0].mode="hidden"});RIOvideoElem.appendChild(track);RIOvideoElem.setAttribute("crossorigin","anonymous");RIOvideoElem.setAttribute("nativesubtitles","false");if(document.getElementsByClassName("div-subtitle_icon")[0]!==undefined){document.getElementsByClassName("div-subtitle_icon")[0].style.display="inline-block"}}}}else{if(document.getElementsByClassName("div-subtitle_icon")[0]!==undefined){document.getElementsByClassName("div-subtitle_icon")[0].style.display="none"}}}}function addEvent(d,b,a){if(typeof d=="string"){if(null==(d=document.getElementById(d))){throw new Error("Elemento HTML não encontrado. Não foi possível adicionar o evento.")}}if(d.attachEvent){return d.attachEvent(("on"+b),a)}else{if(d.addEventListener){return d.addEventListener(b,a,true)}else{throw new Error("Seu browser não suporta adição de eventos. Baixe um navegador mais recente.")}}}function mouseCoords(a){if(typeof(a.pageX)!=="undefined"){return{x:a.pageX,y:a.pageY}}else{return{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}}}function getPosition(g,a){var a=a||window.event;if(g.constructor==String){g=document.getElementById(g)}var f=0,d=0;var b=mouseCoords(a);while(g.offsetParent){f+=g.offsetLeft;d+=g.offsetTop;g=g.offsetParent}f+=g.offsetLeft;d+=g.offsetTop;return{x:b.x-f,y:b.y-d}}function dragdrop(d,b){var a=window||document;objSelec=d;objSelec.style.cursor="move";a.addEventListener("mousemove",moveDiv);objSelec.addEventListener("mouseup",removeEvent)}function rulesThree(f){var d=window;var h=document;var g=h.documentElement;h=h.getElementsByTagName("body")[0];var b=d.innerWidth||g.clientWidth||g.clientWidth;var a=d.innerHeight||g.clientHeight||g.clientHeight;var e=f*100/b;return e}function removeEvent(){var a=window||document;var b=document.getElementById("div-drag-resize");if(a.addEventListener){a.removeEventListener("mousemove",moveDiv);b.removeEventListener("mouseup",removeEvent);b.style.cursor="col-resize"}}function moveDiv(k){var g=k||window;var d=document.getElementById("div-drag-resize");var n=document.getElementById("divvideo");var b=document.getElementById("index");var a=document.getElementById("RIOslides");var f=document.getElementById("RIOslideBar");var h=document.getElementById("RIOtoolBar");btnChaL=document.getElementById("btn-change-right");btnChaR=document.getElementById("btn-change-left");if(d){var m=k||window.event;var o=mouseCoords(m);var l=d.parentNode;var p=rulesThree(o.x-l.offsetLeft);if(n.className.indexOf("revert")==-1){if(p<20){d.style.left="20%";btnChaL.style.left="15%";btnChaR.style.left="15%";n.style.width="20%";b.style.width="20%";a.style.width=(100-20)+"%";f.style.width=(100-20)/2+"%";h.style.width=(100-20)/2+"%";a.style.left="20%";f.style.left="20%";h.style.left=20+(100-20)/2+"%"}else{if(p>80){d.style.left="80%";btnChaL.style.left="75%";btnChaR.style.left="75%";n.style.width="80%";b.style.width="80%";a.style.width=(100-80)+"%";f.style.width=(100-80)/2+"%";h.style.width=(100-80)/2+"%";a.style.left="80%";f.style.left="80%";h.style.left=80+(100-80)/2+"%"}else{d.style.left=p+"%";btnChaL.style.left=(p-5)+"%";btnChaR.style.left=(p-5)+"%";n.style.width=p+"%";b.style.width=p+"%";a.style.width=(100-p)+"%";f.style.width=(100-p)/2+"%";h.style.width=(100-p)/2+"%";a.style.left=p+"%";f.style.left=p+"%";h.style.left=p+(100-p)/2+"%"}}}else{if(p<20){d.style.left="20%";btnChaL.style.left="15%";btnChaR.style.left="15%";a.style.width="20%";b.style.width="20%";n.style.width=(100-20)+"%";f.style.width=(100-20)/2+"%";h.style.width=(100-20)/2+"%";n.style.left="20%";f.style.left="20%";h.style.left=20+(100-20)/2+"%"}else{if(p>80){d.style.left="80%";btnChaL.style.left="75%";btnChaR.style.left="75%";a.style.width="80%";b.style.width="80%";n.style.width=(100-80)+"%";f.style.width=(100-80)/2+"%";h.style.width=(100-80)/2+"%";n.style.left="80%";f.style.left="80%";h.style.left=80+(100-80)/2+"%"}else{d.style.left=p+"%";btnChaL.style.left=(p-5)+"%";btnChaR.style.left=(p-5)+"%";a.style.width=p+"%";b.style.width=p+"%";n.style.width=(100-p)+"%";f.style.width=(100-p)/2+"%";h.style.width=(100-p)/2+"%";n.style.left=p+"%";f.style.left=p+"%";h.style.left=p+(100-p)/2+"%"}}}d.style.margin="0px";return false}}function savingMsg(){document.getElementsByClassName("saving-slides")[0].style.display="table";var a=setInterval(function(){document.getElementsByClassName("saving-slides")[0].style.display="none";clearInterval(a)},3000)}function changeSlideVideo(){var h=document.getElementById("div-drag-resize");var a=document.getElementById("divvideo");var g=document.getElementById("index");var d=document.getElementById("RIOslides");var e=document.getElementById("RIOslideBar");var k=document.getElementById("RIOtoolBar");h.setAttribute("style","");a.setAttribute("style","");d.setAttribute("style","");e.setAttribute("style","");k.setAttribute("style","");var b=a.className;var f=d.className;if(b.indexOf("revert")!=-1){a.className="";a.className="RIOdivvideo";d.className="";d.className="RIOslides"}else{if(b.indexOf("revert")==-1){a.className="";a.className="RIOdivvideo revert";d.className="";d.className="RIOslides revert"}}}function showBtnChange(d){var a=document.getElementById("divvideo").className;var b="";var e="";if(a.indexOf("revert")==-1){b="btn-change-right";e="btn-change-left"}else{b="btn-change-left";e="btn-change-right"}if(d.id=="divvideo"){document.getElementById(b).style.display="inline-block";document.getElementById(e).style.display="none"}else{if(d.id=="RIOvideo"){document.getElementById(b).style.display="inline-block";document.getElementById(e).style.display="none"}else{if(d.id==b){document.getElementById(b).style.display="inline-block";document.getElementById(e).style.display="none"}else{document.getElementById("btn-change-left").style.display="none";document.getElementById("btn-change-right").style.display="none"}}}}function resizeImg(k,h){var e=k.clientHeight;var a=k.clientWidth;var f=h.width;var b=h.height;var d=b/e;var g=f/a;if(d>g){h.style.height=e+"px";h.style.width="auto"}else{h.style.width=e+"px";h.style.height="auto"}}function videoToLibras(){var g=document.getElementById("RIOvideo");var e=document.getElementById("RIOlibrasvideo");var a=g.getElementsByTagName("source")[1].src;var f=g.getElementsByTagName("source")[0].src;var d=e.getElementsByTagName("source")[1].src;var b=e.getElementsByTagName("source")[0].src;e.getElementsByTagName("source")[0].src="";e.getElementsByTagName("source")[0].src=f;e.getElementsByTagName("source")[1].src="";e.getElementsByTagName("source")[1].src=a;g.getElementsByTagName("source")[0].src="";g.getElementsByTagName("source")[0].src=b;g.getElementsByTagName("source")[1].src="";g.getElementsByTagName("source")[1].src=d;g.load();e.load()}function resizeSlideInGallery(){if(isImage=="true"){var e=document.body.clientHeight;var a=document.body.clientWidth;var f=slideElem.width;var b=slideElem.height;var d=b/e;var g=f/a;if(d>g){slideElem.style.height="99%";slideElem.style.width="auto"}else{slideElem.style.width="100%";slideElem.style.height="auto"}}}function verifyThumb(b){var a=b.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("thumbnail")[0];if(a!=undefined){a=b.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("videoaula")[0].getElementsByTagName("technical")[0].getElementsByTagName("thumbnail")[0].getElementsByTagName("entry")[0].childNodes[0].nodeValue}else{a="not thumbnail"}return a}function RIOresizeImageGallery(d,e,h){var l=d.clientHeight;var a=d.clientWidth;var k=e.clientWidth;var b=e.clientHeight;var f=b/l;var g=k/a;if(f>g){e.style.height="85%";e.style.width="95%"}else{h.style.width="95%";e.style.width="95%";e.style.height="85%"}}function preResizeSlides(b){var a=document.getElementsByClassName("image-gallery");for(var d=0;d<a.length;d++){var f;var e=a[d].getElementsByTagName("div")[3];if(e.getElementsByTagName("img")[0]==undefined){var f=e.getElementsByTagName("iframe")[0]}else{if(e.getElementsByTagName("iframe")[0]==undefined){var f=e.getElementsByTagName("img")[0]}}if(b===1&&d>0){RIOresizeImageGallery(e.getElementsByTagName("div")[0],f,a[d].getElementsByTagName("div")[0])}else{if(b===0){RIOresizeImageGallery(e.getElementsByTagName("div")[0],f,a[d].getElementsByTagName("div")[0])}}}}function changeTabs(a){if(a.id==="scriptclass"){a.className="tabs-bar scriptclass activated";document.getElementById("librasclass").className="tabs-bar librasclass deactivated";document.getElementById("RIOLibras-tool-fixed").style.display="none";var b=document.getElementById("index");b.className="RIOindex"}else{if(a.id==="librasclass"){a.className="tabs-bar librasclass activated";document.getElementById("scriptclass").className="tabs-bar scriptclass deactivated";var b=document.getElementById("index");b.className="RIOindex orientation";document.getElementById("RIOLibras-tool-fixed").style.display="inline-block"}else{if(a.className==="div-videoToslide"||a.className==="div-videoToslide activated"){if(a.className==="div-videoToslide"){a.className="div-videoToslide activated"}else{if(a.className==="div-videoToslide activated"){a.className="div-videoToslide"}}}else{if(a.className==="div-videoToLibras"||a.className==="div-videoToLibras activated"){if(a.className==="div-videoToLibras"){a.className="div-videoToLibras activated"}else{if(a.className==="div-videoToLibras activated"){a.className="div-videoToLibras"}}}else{if(a.className==="div-subtitle_icon"||a.className==="div-subtitle_icon activated"){if(a.className==="div-subtitle_icon"){a.className="div-subtitle_icon activated";RIOvideoElem=document.getElementById("RIOvideo");if(RIOVideoSubtitlesDefaultIndex!=-1){document.getElementById("RIOvideo").getElementsByTagName("track")[0].mode="showing";RIOvideoElem.textTracks[0].mode="showing"}}else{if(a.className==="div-subtitle_icon activated"){a.className="div-subtitle_icon";RIOvideoElem=document.getElementById("RIOvideo");document.getElementById("RIOvideo").getElementsByTagName("track")[0].mode="hidden";RIOvideoElem.textTracks[0].mode="hidden"}}}}}}}}function ballonRights(){if(RIOxmlDoc!==undefined){if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula").length!==0){if(RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("rights").length!==0){document.getElementById("li-rigths-rules").innerHTML='<div> <label style="position: relative; left: 15%;"> Esta videoaula utiliza a licença: </label></div><div><b style="position: relative; left: 6%;">'+RIOxmlDoc.getElementsByTagName("OBAA_Videoaula")[0].getElementsByTagName("rights")[0].getElementsByTagName("description")[0].getElementsByTagName("string")[0].childNodes[0].nodeValue+"</b> </div>";if(document.getElementById("tooltip-rights").style.display=="none"){document.getElementById("tooltip-rights").style.display="inline-block"}else{if(document.getElementById("tooltip-rights").style.display="inline-block"){document.getElementById("tooltip-rights").style.display="none"}}}}}}function iframeClickCreative(){document.getElementById("creativeImage").contentWindow.document.body.onclick=function(){ballonRights()}}function dont(a){console.log(a.button);if(a.button==2){a.preventDefault();a.stopPropagation();return false}}function verifyWinAct(){var b=(function(){var f,d,e={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(f in e){if(f in document){d=e[f];break}}return function(g){if(g){document.addEventListener(d,g)}return !document[f]}})();var a=b()?"Visible":"Not visible";RIOdebug("RIOactiveTab: "+a)}function trackingWayUser(){RIOdebug("RIOtrackUserUrl: "+document.referrer)};